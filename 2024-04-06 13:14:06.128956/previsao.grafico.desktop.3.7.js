var canvas=document.getElementById('quadroBoia');var canvasEstacao=document.getElementById('quadroMet');var ctx;var ctxEstacao;var cxBoia=530;var cyBoia=100;var raioRosaBoia=70;var gx=25;var gy=222;var cxEstacao=560;var cyEstacao=67;var raioEstacao=40;var gxEstacao=25;var gyEstacao=245;var dxEstacao=320;var dyEstacao=165;var lx=0;var ly=0;var xScrollPos0=-1;var canvasMare=document.getElementById('tina');var ctxMare;var ctxMare=560;var gxMare=26;var gyMare=160;var fatorMare=5;var sxMare=25;var syMare=300;var syMareMax=55;var sStepMare=3.3;var sfatorMare=2;var maxImagens=32;var mapaId=0;var temMapa=true;var imgDia='';var idReg=-1;var imgSrc=new Image(4160,1040);var imgLrSrc=new Image(4160,1040);var img2Src=new Image(4160,1040);var img2lrSrc=new Image(4160,1040);var img3Src=new Image(2394,534);var img4Src=new Image(2394,534);var img5Src=new Image(2394,534);var img6Src=new Image(2394,534);var img7Src=new Image(2394,534);var img8Src=new Image(2394,534);var i=new Image(2394,534);var playSrc=new Image(26,26);var stopSrc=new Image(26,26);var imagem_atual=1;var tipoImagem=1;var hora_atual=0;var alturaMapa=260;var comprMapa=260;var comprMapaBr=266;var alturaMapaBr=267;var mapaOff=false;var xImagemAtmos=0;var xImagemZoomAtmos=0;var idUnidVento=1;var id_box=0;$(function(){$('#mudar-previsao').click(function(){$('#titulo-local').hide();$('#barra-topo').fadeIn();});$('#leia-mais').click(function(){$('#leia-mais').hide();$('h2').attr("style","width: 95%;");const h=$('h2').height()+20;$('#casa-descricao').height(h);});unid_vento=idUnidVento;playSrc.src='/img/play.gif';stopSrc.src='/img/stop.gif';boltImg.src='/img/bolt.gif';$(".quadrado_dia").show();$("#botao_dia1 .seta9").show();$("#scroll_ondas .dragger").mousedown(ondas_mousedown);$("#scroll_vento .dragger").mousedown(vento_mousedown);$("#scroll_mares .dragger").mousedown(mares_mousedown);$("#scroll_mapas .dragger").mousedown(mapas_mousedown);$("#scroll_tempo .dragger").mousedown(tempo_mousedown);$("#scroll_energia .dragger").mousedown(energia_mousedown);$("#btn-barra4").toggleClass("barra-fechada");$('#conteudo-box4').slideToggle('slow',function(){});if(temCameras){carregaCameras();}
canvasMare=document.getElementById('tina');ctxMare=canvasMare.getContext('2d');canvasTempo=document.getElementById('canvas_tempo');ctxTempo=canvasTempo.getContext('2d');canvas_escala_tempo_esq=document.getElementById('canvas_escala_tempo_esq');ctxEscalaTempoEsq=canvas_escala_tempo_esq.getContext('2d');canvas_escala_tempo_dir=document.getElementById('canvas_escala_tempo_dir');ctxEscalaTempoDir=canvas_escala_tempo_dir.getContext('2d');canvasEspectro=document.getElementById('canvas_espectro');ctxEspectro=canvasEspectro.getContext('2d');canvas_mare=document.getElementById('tina');ctx_mare=canvas_mare.getContext('2d');canvas_mare_escala_esq=document.getElementById('mare_escala_esq');ctx_mare_escala_esq=canvas_mare_escala_esq.getContext('2d');ctx_mare.font="11px Verdana";$(".envoltorio_graficos").scroll(function(){var sl=$(this).scrollLeft();setDiaMare(Math.floor(sl/34)+1);});$("#canvas_tempo").mousemove(function(event){relX_tempo=event.pageX-$(this).offset().left;relY_tempo=event.pageY-$(this).offset().top;});$("#tina").mousemove(function(event){relX_mare=event.pageX-$(this).offset().left;relY_mare=event.pageY-$(this).offset().top;});$("#quadroMet").mousemove(function(event){relX_Estacao=event.pageX-$(this).offset().left;relY_Estacao=event.pageY-$(this).offset().top;});$("#quadroBoia").mousemove(function(event){relX_boia=event.pageX-$(this).offset().left;relY_boia=event.pageY-$(this).offset().top;});if(praia_id==0)$("#menu_mapas3").hide();$("#seleciona_tabelas").click(function(){window.location.href=webroot+"previsao/"+locais+"?tipo=tabela";});$("#play_stop_botao").click(function(){liga=!liga;if(liga){goloop();document.play_stop_botao.src=stopSrc.src;}
else{document.play_stop_botao.src=playSrc.src;}});$("#conteudo-box4").hide();$("#menu_boias").hide();$("#menu_estacoes").hide();$("#resumo-box11").hide();energia_resumo_on=false;apagaDadosOndas();apagaDadosVento();apagaDadosEnergia();if(offsetMapaAtualizacao>0)selec(1+offsetMapaAtualizacao);$("#mapas_pressao_regiao").hide();$("#mapas_pressao_pais").hide();$("#mapas_atmos_regiao").hide();$("#mapas_atmos_pais").hide();inicializaPagina();});$(".btn-barra").click(function(){$(this).toggleClass("barra-fechada");id_box=$(this).data('id');$('#conteudo-box'+id_box).slideToggle('slow',function(){if(id_box==11){if(energia_resumo_on){$("#resumo-box11").hide();energia_resumo_on=false;}else{$("#resumo-box11").show();energia_resumo_on=true;}}});});function inicializaPagina(){if(usuarioStatus!=null&&usuarioStatus>0){$("#organize-atividades").load("/atividades/ultima");$("#titulo-atividades").remove();$("#menu-atividades").show();$("#sections-atividades").show();$("#titulo_sem_atividades").remove();}else{$("#menu-atividades").remove();$("#sections-atividades").remove();$("#titulo_sem_atividades").show();}
if(praia_id>0){$("#espectro_praia").show();$("#bTipoGmap1").hide();}
maxImagens=16-2*numAtraso;fx=0.05;if(usuarioStatus==1){pro=1;barra_dias_dx=-3.53;graficos_dx=-3.68;fx=0.097;numAtraso2=numAtraso;maxImagens=32-2*numAtraso;pro=1;numDiaFinal=17;maxDias=16;$("#txt_previsao_prolongada").hide();$(".aviso_login").hide();}else{$("#barra_dias").attr("style","width: 1100px;");$("#seleciona_historico").hide();}
lerJsonMeteoro();lerJsonOceano();if(usuarioStatus!=1){$("#txt_previsao_prolongada").attr("style","float: left;margin: 20px 0 0 40px;");for(var d=8;d<16;d++){$("#botao_dia"+String(d+1)).remove();$("#altura_dia"+String(d+1)).remove();$("#altura_dia"+String(d+1)+"_title").remove();$("#energia_dia_"+String(d+1)+"_title").remove();$("#dia_energia_"+String(d+1)).remove();$("#vento_dia"+String(d+1)+"_title").remove();$("#casa_vento_dia"+String(d+1)).remove();$("#casa_tempo_dia"+String(d+1)).remove();}}else{}}
function historico(){var dat=$("#datepicker").val();dat=dat.replaceAll("-","");var pr=praia.trim();if(pr=="")pr="oceanica";var act="/historico/"+pais+"/"+estado+"/"+cidade+"/"+pr+"/"+dat;$("#hindcast_form").attr("action",act).submit();}
function mostraGrafico(tipo){$("li[id^='aba_grafico_']").each(function(c){$(this)[0].className="normal";});$('#aba_grafico_'+tipo)[0].className="ativa";$("li[id^='aba_grafico_energia_']").each(function(c){$(this)[0].className="normal";});$('#aba_grafico_energia_'+tipo)[0].className="ativa";for(var c=0;c<tipoOndas.length;c++){if(tipoOndas[c]==tipo){idTipo=c;break;}}
mostraValoresOceano();}
function selecionaAba(aba){$('.mapa-previsao .abas li').each(function(){$(this)[0].className="normal";});$('#b'+aba)[0].className="ativa";$(".titulo_mapa_previsao").hide();$('#titulo_'+aba).show();xImagemBr=-(tipoImagem-1)*comprMapa;liberaTxt=false;switch(aba){case 'altura':load(1);break;case 'periodo':load(2);break;case 'vento':load(3);liberaTxt=true;break;case 'tempo':load(4);liberaTxt=true;break;case 'tsm':load(5);break;case 'espectro':showEspectro();break;}}
function mostraValoresOceano(){$("#aguarde_dados_altura").hide();var minAT,minPP,minPV,minPS,minPN,minV,minVM,minAV,minAS,minAN,minDP,minD,minDM,minDV,minDS,minDN,minTA,minPC,minCN,minCP,minPA;var maxAT,maxPP,maxPV,maxPS,maxPN,maxV,maxVM,maxAV,maxAS,maxAN,maxDP,maxD,maxDM,maxDV,maxDS,maxDN,maxTA,maxPC,maxCN,maxCP,maxPA;var minENT,maxENT,minPTT,maxPTT,minENV,maxENV,minPTV,maxPTV,minENSS,maxENSS,minPTSS,maxPTSS,minENSN,maxENSN,minPTSN,maxPTSN;var objeto1,objeto2,objeto3,objeto4,unid,tipoDir,horario,texto,compl="";var altura,angulo,angulo2,bg,tipo_vento,periodo,direcao,hora,mare,mare2,per,dir,ce,vv,nr=0;var dadoValido=true;var erro=false;var intervalo=3;var enFim,potFim,ha,hb,d,dd,ds,vv,rr,dv,dt,mm,aa,da,ma,ya,sds;var numDiaAtual,numMesAtual,numAnoAtual,numHoraAtual,potencia,energia;ha=2;hb=4;hc=6;hd=8;numDiaAtual=Math.floor(diaIni);numMesAtual=Math.floor(mesIni);numAnoAtual=Math.floor(anoIni);if(numAnoAtual/4==Math.floor(numAnoAtual/4))diaFim[2]=29;else diaFim[2]=28;if(previsaoAntiga){totalHoras=4;larg=26;intervalo=6;compl="width:"+larg+"px;";ha=2;hb=3;}
decodEspectro();drawEspectro(1,0);var ma=10*Math.floor(maxAltura/10)+10;if(localAtivo){if(ma>30){ajustaAlturaOndas(ma);}}else{if(ma>15){ajustaAlturaOndas(ma);}}
if(maxMares>0){diaIniMares+=numAtrasoDados;diaSelectMare=1+numAtrasoDados;mudaTipoPrevisaoMare();$('#mares_display').show();}else if(maxMares==0){$('#mares_display').hide();}
if(tsm<100){setLeituraTsm();}
drawGraficoTempo();zoom();var tipo2=idTipo;if(mostraSurf)tipo2+=4;if(unidadeAltura=='m'){fatorUnid=10;strUnid="m";strUnidExt="metros";}else{fatorUnid=3.05;strUnid="ft";strUnidExt="feet";}
console.log(max_potencia);if(!alturaEnergiaAjustada){if(max_energia>3000){console.log(max_energia);ajustaAlturaEnergia();}
if(max_potencia>100){ajustaAlturaPotencia();}}
for(var d=1+numAtrasoDados;d<=maxDias+numAtrasoDados;d++){dd=d-numAtrasoDados;da=numDiaAtual+d-1;mm=numMesAtual;if(da>diaFim[numMesAtual]){da-=diaFim[numMesAtual];mm++;if(mm==13)mm=1;}
ds=dSem+d-1;while(ds>7){ds-=7;}
sds=String(da);if(da<10)sds="0"+sds;for(var h=1;h<=totalHoras;h++){if(!(typeof(dadosAltura[d])=="undefined"||typeof(dadosAltura[d][h])=="undefined")){objeto1='#dia'+dd+'_hora'+h;objeto2='#title_dia'+dd+'_hora'+h;switch(tipo2){case 0:altura=dadosAltura[d][h];periodo=dadosPeriodo[d][h];direcao=dadosDirPrim[d][h];tipoDir="primaria";break;case 1:altura=dadosVagas[d][h];periodo=dadosPerVag[d][h];direcao=dadosDirVag[d][h];tipoDir="vagas";break;case 2:altura=dadosSul[d][h];periodo=dadosPerSul[d][h];direcao=dadosDirSul[d][h];tipoDir="swell";break;case 3:altura=dadosNorte[d][h];periodo=dadosPerNorte[d][h];direcao=dadosDirNorte[d][h];tipoDir="swell";break;case 4:altura=dadosSurf[d][h];periodo=dadosPeriodo[d][h];direcao=dadosDirPrim[d][h];tipoDir="primaria";break;case 5:altura=dadosVagasSurf[d][h];periodo=dadosPerVag[d][h];direcao=dadosDirVag[d][h];tipoDir="vagas";break;case 6:altura=dadosSulSurf[d][h];periodo=dadosPerSul[d][h];direcao=dadosDirSul[d][h];tipoDir="swell";break;case 7:altura=dadosNorteSurf[d][h];periodo=dadosPerNorte[d][h];direcao=dadosDirNorte[d][h];tipoDir="swell";}
dadoValido=(altura>1);for(per=0;per<limitePeriodo.length;per++){if(limitePeriodo[per]>periodo)break}
if(typeof(objeto1[0])!="undefined"&&typeof(objeto2[0])!="undefined"){erro=false;try{$(objeto1)[0].className="ep"+per;}catch{erro=true;}
if(!erro){dir=Math.floor((direcao+11.2)/22.5);if(altura<=10){unid=" metro"}
else{unid=" metros"}
if(dadoValido){$(objeto1).attr("style","height:"+String(fator*altura)+"px;left:"+larg*(h-1)+"px;"+compl);$(objeto2).attr("style","height:"+String(altura_display_ondas)+"px;left:"+larg*(h-1)+"px;"+compl);}
else{$(objeto1).attr("style","height:0;left:"+8*(h-1)+"px;");$(objeto2).attr("style","height:"+String(altura_display_ondas)+";left:"+8*(h-1)+"px;");}
objeto1='#energia_dia'+dd+'_hora'+h;objeto2='#title_energia_dia'+dd+'_hora'+h;switch(tipo2){case 0:energia=dadosEnTot[d][h];potencia=dadosPoTot[d][h];break;case 1:energia=dadosEnVagas[d][h];potencia=dadosPoVagas[d][h];break;case 2:energia=dadosEnSul[d][h];potencia=dadosPoSul[d][h];break;case 3:energia=dadosEnNorte[d][h];potencia=dadosPoNorte[d][h];break;case 4:energia=dadosEnTot[d][h];potencia=dadosPoTot[d][h];break;case 5:energia=dadosEnVagas[d][h];potencia=dadosPoVagas[d][h];break;case 6:energia=dadosEnSul[d][h];potencia=dadosPoSul[d][h];break;case 7:energia=dadosEnNorte[d][h];potencia=dadosPoNorte[d][h];}
potencia=potencia/10;if(dadoValido){if(mostraEnergia){if(d==2){"height:"+String(Math.round(fatorEnergia*energia))+"px;";}
$(objeto1).attr("style","height:"+String(Math.round(fatorEnergia*energia))+"px;left:"+larg*(h-1)+"px;"+compl);$(objeto2).attr("style","height:"+String(Math.round(fatorEnergia*energia))+"px;left:"+larg*(h-1)+"px;"+compl);if(potencia<=limitesPotencia[0]/10){$(objeto1)[0].className="ep2";}else if(potencia>limitesPotencia[limitesPotencia.length]/10){$(objeto1)[0].className="ep18";}else{for(cp=0;cp<=limitesPotencia.length;cp++){if(potencia<=limitesPotencia[cp]){$(objeto1)[0].className="ep"+String(cp+1);break;}}}}else{$(objeto1).attr("style","height:"+String(Math.round(50*fator*potencia/(20*stepPotencia)))+"px;left:"+larg*(h-1)+"px;"+compl);$(objeto2).attr("style","height:"+String(Math.round(50*fator*potencia/(20*stepPotencia)))+"px;left:"+larg*(h-1)+"px;"+compl);if(energia<=limitesEnergia[0]){$(objeto1)[0].className="ep2";}else if(energia>limitesEnergia[limitesEnergia.length]){$(objeto1)[0].className="ep18";}else{for(cp=0;cp<=limitesEnergia.length;cp++){if(energia<=limitesEnergia[cp]){$(objeto1)[0].className="ep"+String(cp+1);break;}}}}}
else{$(objeto1).attr("style","height:0;left:"+8*(h-1)+"px;");$(objeto2).attr("style","height:"+String(altura_display_energia)+";left:"+8*(h-1)+"px;");}}}
if(h==ha||h==hb||h==hc||h==hd){switch(h){case ha:nr=1;horario="Madrugada: ";break;case hb:nr=2;horario="Manhã: ";break;case hc:nr=3;horario="Tarde: ";break;case hd:nr=4;horario="Noite: ";}
dir=Math.floor((direcao+11.25)/22.5);if(dadoValido){$("#altura_dia"+dd+" .direcao"+nr).html("<span title='"+horario+direcoes_graficos_extenso[dir]+" | "+direcao+" graus' class='icone icone-periodo "+direcoes_graficos[dir]+"'></span><div class='txt_dir'>"+direcoes_graficos[dir]+"</div>");}else{$("#altura_dia"+dd+" .direcao"+nr).empty();}}}}
$("#resumo_energia_"+dd+" .resumo_energia_dia").html(diaSem[ds]+" "+sds);if(typeof(dadosEnTot[d])!="undefined"){energia=dadosEnTot[d][3];potencia=dadosPoTot[d][3]/10;enFim=dadosEnTot[d][6];potFim=dadosPoTot[d][6]/10;if(potencia<10)strPotencia=String(potencia);else strPotencia=String(Math.round(potencia));strPotencia=strPotencia.replace(".",",");if(enFim>energia)tendencia="▲";else if(enFim<energia)tendencia="▼";$("#resumo_energia_"+dd+" .resumo_energia_en").html(energia+" J "+tendencia);if(potFim>potencia)tendencia="▲";else if(potFim<potencia)tendencia="▼";$("#resumo_energia_"+dd+" .resumo_energia_pot").html(strPotencia+" kW "+tendencia);}}
if(boia!=""&&boia!="0"){$('#boia_display').fadeIn(1000);lerBoia();}
if(praia_id==0){praia_lat=lat;praia_lon=lon;praia_zoom=8;}
if(estacaoMare!="-"&&maxMares>0){mudaTipoPrevisaoMare();}
if(idEstacaoTempo.length>2){lerEstacao();}else{$('#titulo_estacao').hide();}
ventoOk=true;tabelaPreenchida=true;h=$('#conteudo-previsao').height();$('#lateral-previsao').height(h);}
function setLeituraTsm(){if(unidadeAltura=='f'){$('.grauc_tsm').html("°F");tsm=Math.round(9*tsmFull/5+32);}else{$('.grauc_tsm').html("°C");tsm=Math.round(tsmFull);}
$('#leitura_tsm').html(tsm);$('#leitura_tsm2').html(tsm);var ts=2*Math.floor(tsmFull/2);try{$('#leitura_tsm')[0].className="et"+ts;$('#leitura_tsm2')[0].className="et"+ts;if(tsmFull>29.4||tsmFull<7.5){$('#leitura_tsm').attr("style","color:#fff;");$('#leitura_tsm2').attr("style","color:#fff;");}}catch(e){}
dd=parseInt(diaHoje)-1;mm=parseInt(mesHoje);aa=parseInt(anoHoje);if(dd<1){mm--;if(mm==0){mm=12;aa--;}
dd=diaFim[mm];}
$(".data_tsm").html("Temperatura medida em "+dd+" de "+nomeMesExtenso[mm]+" de "+aa);}
function ajustaAlturaVento(){altura_display_vento=parseInt(unidadesRazao[idUnidVento]*5*maxVento);$("div[id^='casa_vento_dia']").each(function(){$(this).attr("style","height:"+String(altura_display_vento+22)+"px;");});$('#vento_display .envoltorio_graficos').attr("style","height:"+String(altura_display_vento+92)+"px;");$('#titles_vento').attr("style","height:"+String(altura_display_vento+22)+"px;");$('#titles_vento .envoltorio_dia_titles').attr("style","height:"+String(altura_display_vento+22)+"px;");$('#vento_display .envoltorio_escala').attr("style","height:"+String(altura_display_vento-20)+"px;");$('#vento_display .envoltorio_escala_lateral').attr("style","height:"+String(altura_display_vento+40)+"px;");$('#vento_display').attr("style","height:"+String(altura_display_vento+117)+"px;");ajustadoVento=true;}
var liberaTxt=false;function mostraTxt(m){if(liberaTxt){if(m==0){$("#textos_mapa").fadeIn(1000);}
else{$("#textos_mapa_zoom").fadeIn(1000);}}}
function escondeTxt(m){if(m==0)$("#textos_mapa").fadeOut(1000);else $("#textos_mapa_zoom").fadeOut(1000);}
function drawLeitura(d,h){var dma=new Array(3);dma=dat[d].split("-");var dt=new Date(dat[d]);var dsem=dt.getDay();var pp=dir=mt=0;var vv="";var smt="";ctx.fillStyle="#ccc";ctx.fillRect(10,28,420,25);ctx.fillStyle="#eee";ctx.fillRect(10,53,420,58);ctx.fillStyle="#000";ctx.font="18px verdana";if(((temDadosHoje&&d==0)||(!temDadosHoje&&d==1))&&h==0)ctx.fillText("Ultima leitura:",15,47);ctx.fillStyle="#900";ctx.fillText(dma[2]+"/"+nomeMes[Math.floor(dma[1])],160,47);ctx.fillText("("+nomeDiaSem[dsem]+")",230,47);ctx.fillText(horaBoia[d][h].substr(0,5)+"h",350,47);if(temDir||temDirVento){drawRosa();}
ctx.font="18px verdana";ctx.fillStyle="#090";ctx.fillText("Ondas:",15,75);ctx.font="20px verdana";ctx.fillStyle="#090";hs=parseFloat(alturaSig[d][h]);var strUnid="m ";if(unidadeAltura=='f'){hs=Math.round(10*hs/0.328)/10;strUnid="ft ";}
ctx.fillText("        "+strUnid+"|     s |       \u00b0",15,97);ctx.font="22px verdana";ctx.fillStyle="#090";aa=String(hs);aa=aa.replace(".",",");if(aa.length<3)aa=aa+",0";ctx.fillText(aa,20,102);if(periodoBoia[d][h]!=""&&!isNaN(periodoBoia[d][h])){pp=Math.floor(periodoBoia[d][h]);if(pp>25)pp=Math.round(pp/10);ctx.fillText(pp,110,102);}else{ctx.fillText(" - ",110,102);}
vv=direcaoOndas[d][h];if(!isNaN(vv)){while(vv.length<3)vv="0"+vv;ctx.fillText(vv,175,102);if(temDir){ctx.font="12px verdana";ctx.fillStyle="#000";dir=Math.floor((Math.floor(direcaoOndas[d][h])+11.2)/22.5);ctx.fillText(direcoes_graficos_extenso[dir],100,73);drawSetaOndas(Math.floor(direcaoOndas[d][h]));}}
if(temVento){ctx.fillStyle="#33d";ctx.font="18px verdana";ctx.fillText("Vento:",250,75);ctx.font="20px verdana";ctx.fillText("     n\u00f3s |       \u00b0",250,97);ctx.font="22px verdana";ctx.fillText(vento[d][h],250,102);vv=ventoDir[d][h];if(vv!=""&&!isNaN(vv)){while(vv.length<3)vv="0"+vv;ctx.fillText(vv,345,102);if(temDirVento){ctx.fillStyle="#000";ctx.font="12px verdana";dir=Math.floor((Math.floor(ventoDir[d][h])+11.2)/22.5);ctx.fillText(direcoes_graficos_extenso[dir],315,73);drawSetaVento(Math.floor(ventoDir[d][h]));}}else{ctx.fillText("-",345,102);}}else if(temTemp){ctx.fillStyle="#d33";ctx.font="18px verdana";ctx.fillText("Temperatura:",235,75);ctx.font="14px verdana";ctx.fillText("\u00c1gua         \u00b0"+unidadeTemperatura.toUpperCase()+" |",235,97);ctx.font="16px verdana";if(martemp[d][h]!=""&&!isNaN(martemp[d][h])){if(unidadeTemperatura=='f')mt=Math.round(10*(9*martemp[d][h]/5+32))/10;else mt=Math.round(10*martemp[d][h])/10;smt=String(mt);if(smt.length<3)smt=smt+".0";smt=smt.replace(".",",");ctx.fillText(smt,278,100);}else{ctx.fillText(" - ",278,100);}
if(artemp[d][h]!=""&&!isNaN(artemp[d][h])){if(unidadeTemperatura=='f')mt=Math.round(10*(9*artemp[d][h]/5+32))/10;else mt=Math.round(10*artemp[d][h])/10;smt=String(mt);if(smt.length<3)smt=smt+".0";smt=smt.replace(".",",");ctx.font="14px verdana";ctx.fillText("Ar         \u00b0"+unidadeTemperatura.toUpperCase(),345,97);ctx.font="16px verdana";ctx.fillText(smt,368,100);}}}
function drawTitulo(){ctx.font="18px verdana";linkText=nome+" ("+idBoia+") "+desc;linkWidth=ctx.measureText(linkText).width;ctx.fillStyle="#000";ctx.fillText(linkText,10,20);canvas.addEventListener("mousemove",on_mousemove_Boia,false);canvas.addEventListener("click",on_click_Boia,false);}
function on_mousemove_Boia(ev){var x=y=d=h=0;x=relX_boia;y=relY_boia;if(temOndas){if(x>gx-4&&x<(gx+403)&&y<gy&&y>(gy-100)){graficoLink=-1;document.body.style.cursor="";for(dd=0;dd<2;dd++){for(cc=0;cc<25;cc++){if(xBotao[cc+25*dd]>=0&&x>=xBotao[cc+25*dd]&&x<=xBotao[cc+25*dd]+10){document.body.style.cursor="pointer";graficoLink=cc+25*dd;break;}}
if(graficoLink>=0)break;}
if(graficoLink<0){document.body.style.cursor="";}
else{if(graficoLink>24){d=1;h=graficoLink-25;}else{d=0;h=graficoLink;}
drawLeitura(d,h);}}else if(x>=linkXini&&x<=(linkXini+linkWidth)&&y<=linkYini&&y>=(linkYini-linkHeight)){document.body.style.cursor="pointer";inLink=true;}
else{if(temDadosHoje)drawLeitura(0,0);else drawLeitura(1,0);document.body.style.cursor="";inLink=false;}}else{document.body.style.cursor="";}}
function on_click_Boia(e){if(inLink){window.open(site,'_blank');}}
function drawRosa(){ctx.clearRect(cxBoia-(raioRosaBoia+10),cyBoia-(raioRosaBoia+25),2*(raioRosaBoia+23),2*(raioRosaBoia+23));ctx.lineWidth=1;ctx.beginPath();ctx.strokeStyle="#bbb";ctx.moveTo(cxBoia+(raioRosaBoia+2)*Math.cos(45*Math.PI/180),cyBoia-(raioRosaBoia+2)*Math.sin(45*Math.PI/180));ctx.lineTo(cxBoia+(raioRosaBoia+2)*Math.cos(225*Math.PI/180),cyBoia-(raioRosaBoia+2)*Math.sin(225*Math.PI/180));ctx.moveTo(cxBoia+(raioRosaBoia+2)*Math.cos(135*Math.PI/180),cyBoia-(raioRosaBoia+2)*Math.sin(135*Math.PI/180));ctx.lineTo(cxBoia+(raioRosaBoia+2)*Math.cos(315*Math.PI/180),cyBoia-(raioRosaBoia+2)*Math.sin(315*Math.PI/180));ctx.stroke();ctx.beginPath();ctx.strokeStyle="#666";ctx.moveTo(cxBoia-(raioRosaBoia+10),cyBoia);ctx.lineTo(cxBoia+(raioRosaBoia+10),cyBoia);ctx.moveTo(cxBoia,cyBoia-(raioRosaBoia+10));ctx.lineTo(cxBoia,cyBoia+(raioRosaBoia+10));ctx.moveTo(cxBoia+raioRosaBoia,cyBoia);ctx.strokeStyle="#000";ctx.arc(cxBoia,cyBoia,raioRosaBoia,0,2*Math.PI,true);ctx.stroke();ctx.beginPath();ctx.arc(cxBoia,cyBoia,3,0,2*Math.PI,true);ctx.fill();ctx.strokeStyle="#888";ctx.lineWidth=3;for(var c=1;c<72;c+=2){ctx.moveTo(cxBoia+(raioRosaBoia+2)*Math.cos(5*c*Math.PI/180),cyBoia-(raioRosaBoia+2)*Math.sin(5*c*Math.PI/180));ctx.arc(cxBoia,cyBoia,(raioRosaBoia+2),-5*c*Math.PI/180,-5*(c+1)*Math.PI/180,true);}
ctx.stroke();ctx.font="18px verdana";ctx.fillText("N",cxBoia-6,cyBoia-(raioRosaBoia+12));ctx.font="14px arial";ctx.fillText("L",cxBoia+(raioRosaBoia+10),cyBoia+5);ctx.fillText("S",cxBoia-5,cyBoia+(raioRosaBoia+22));if(!desenhaO){ctx.fillText("O",cxBoia-(raioRosaBoia+22),cyBoia+5);desenhaO=true;}
ctx.font="12px arial";ctx.fillStyle="#888";ctx.fillText("NE",cxBoia+(raioRosaBoia+4)*Math.cos(45*Math.PI/180),cyBoia-(raioRosaBoia+4)*Math.sin(45*Math.PI/180));ctx.fillText("SO",cxBoia+(raioRosaBoia+23)*Math.cos(223*Math.PI/180),cyBoia-(raioRosaBoia+23)*Math.sin(223*Math.PI/180));ctx.fillText("SE",cxBoia+(raioRosaBoia+10)*Math.cos(310*Math.PI/180),cyBoia-(raioRosaBoia+10)*Math.sin(310*Math.PI/180));ctx.fillText("NO",cxBoia+(raioRosaBoia+17)*Math.cos(142*Math.PI/180),cyBoia-(raioRosaBoia+17)*Math.sin(142*Math.PI/180));}
function drawRosaApagada(){ctx.beginPath();ctx.beginPath();ctx.strokeStyle="#ccc";ctx.fillStyle="#ccc";ctx.moveTo(cxBoia-(raioRosaBoia+10),cyBoia);ctx.lineTo(cxBoia+(raioRosaBoia+10),cyBoia);ctx.moveTo(cxBoia,cyBoia-(raioRosaBoia+10));ctx.lineTo(cxBoia,cyBoia+(raioRosaBoia+10));ctx.moveTo(cxBoia+raioRosaBoia,cyBoia);ctx.arc(cxBoia,cyBoia,raioRosaBoia,0,2*Math.PI,true);ctx.stroke();ctx.font="18px verdana";ctx.fillText("N",cxBoia-6,cyBoia-(raioRosaBoia+12));}
function drawSetasLegenda(){var x=y=0;x=cxBoia-(Math.floor((raioRosaBoia+15)/2));y=cyBoia+(raioRosaBoia+55);ctx.font="12px verdana";ctx.fillStyle="#000";ctx.fillText("Dire\u00e7\u00e3o:",x-(Math.floor((raioRosaBoia-5)/2)),y-22);ctx.font="14px verdana";if(temDir){ctx.fillStyle="#090";ctx.fillText("Ondas",x-(Math.floor((raioRosaBoia-5)/2)),y-7);ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x,y-4);ctx.lineTo(x+20,y-4);ctx.lineTo(x+20,y-8);ctx.lineTo(x+(Math.floor((raioRosaBoia+15)/2)),y);ctx.lineTo(x+20,y+8);ctx.lineTo(x+20,y+4);ctx.lineTo(x,y+4);ctx.fill();}
if(temDirVento){if(temDir)x=cxBoia+30;ctx.fillStyle="#33d";ctx.fillText("Vento",x-23,y-7);ctx.beginPath();ctx.moveTo(x,y);ctx.lineTo(x,y-2);ctx.lineTo(x+20,y-2);ctx.lineTo(x+20,y-8);ctx.lineTo(x+(Math.floor((raioRosaBoia+15)/2)),y);ctx.lineTo(x+20,y+8);ctx.lineTo(x+20,y+2);ctx.lineTo(x,y+2);ctx.fill();}}
function drawSetaVento(ang){var x=cxBoia;var y=cyBoia-(raioRosaBoia-2);var w=10;var h=130;ctx.save();ctx.translate(cxBoia,cyBoia);ctx.rotate((Math.PI/180)*ang);ctx.translate(-cxBoia,-cyBoia);ctx.beginPath();ctx.moveTo(x-2,y);ctx.lineTo(x+2,y);ctx.lineTo(x+2,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x+8,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x,y+(raioRosaBoia-5));ctx.lineTo(x-8,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x-2,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x-2,y);ctx.fillStyle="#33d";ctx.fill();ctx.translate(cxBoia,cyBoia);ctx.rotate((Math.PI/180)*-ang);ctx.translate(-cxBoia,-cyBoia);}
function drawSetaOndas(ang){var x=cxBoia;var y=cyBoia-(raioRosaBoia-2);var w=10;var h=130;ctx.save();ctx.translate(cxBoia,cyBoia);ctx.rotate((Math.PI/180)*ang);ctx.translate(-cxBoia,-cyBoia);ctx.beginPath();ctx.moveTo(x-4,y);ctx.lineTo(x+4,y);ctx.lineTo(x+4,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x+10,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x,y+(raioRosaBoia-5));ctx.lineTo(x-10,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x-4,y+(Math.floor((raioRosaBoia+15)/2)));ctx.lineTo(x-4,y);ctx.fillStyle="#090";ctx.fill();ctx.translate(cxBoia,cyBoia);ctx.rotate((Math.PI/180)*-ang);ctx.translate(-cxBoia,-cyBoia);}
boiaCarregada=false;function lerBoia(){if(!boiaCarregada){canvas=document.getElementById('quadroBoia');ctx=canvas.getContext('2d');if(boia.indexOf("|")>0){boias=boia.split("|");$("#menu_boias").show();for(var i=0;i<boias.length;i++){if(i>1){$('#boia'+String(i-1)).after($('#boia1').clone().attr("id","boia"+i));$('#boia'+i+' a').attr("href","javascript:mostraBoia("+i+");");}
$("#boia"+i+" a").html(boias[i]);};}else{boias[0]=boia;}
mostraBoia(0);boiaCarregada=true;}}
function mostraLegenda(id){if(id==1)$("#entenda").show();else $("#entenda").hide();}
function mostraLegendaEnergia(id){if(id==1)$("#entenda-energia").show();else $("#entenda-energia").hide();}
function mostraLegendaVento(id){if(id==1)$("#entenda-vento").show();else $("#entenda-vento").hide();}
function selecionaEspectroPraia(id){if(id==0){$("#bEspectro0 a")[0].className="ativo";$("#bEspectro1 a")[0].className="normal";$("#mapa_zoom").hide();$("#espectro_praia").show();$("#arrudeia_escala_espectro").show();$("#simbolos_espectro").show();if(praia_id>0){$("#label_espectro").show();}else{$("#titulo_espectro").show();}
if(unidadeAltura=='f')$("#escala_espectro").attr("style","right:0;");else $("#escala_espectro").attr("style","left:0;");if(praia_id>0)$("#menu_mapas3").show();mostraEspectro=true;}else{$("#bEspectro0 a")[0].className="normal";$("#bEspectro1 a")[0].className="ativo";$("#mapa_zoom").show();$("#espectro_praia").hide();$("#arrudeia_escala_espectro").hide();$("#simbolos_espectro").hide();if(praia_id>0){$("#label_espectro").hide();}else{$("#titulo_espectro").hide();}
$("#menu_mapas3").hide();mostraEspectro=false;}}
var tipoMapaGoogle=0;var map;function mudaTipoGmap(tipo){if(tipo==0){tipoMapaGoogle=tipo;$("#map_canvas").attr('style','top:0;');$("#bTipoGmap1").hide();$("#bTipoGmap0").show();}else{tipoMapaGoogle=tipo;$("#map_canvas").attr('style','top:-260px;');$("#bTipoGmap0").hide();$("#bTipoGmap1").show();}
drawEspectro(parseInt((imagem_atual-1)/2)+1,imagem_atual-2*(dia_atual-1)-1);}
nrBoia=-1;function mostraBoia(id){nrBoia=id;idBoia=boias[id];ctx.clearRect(0,0,650,250);ctx.fillStyle="#00c";ctx.font="38px verdana";ctx.fillText("Aguarde... Carregando dados.",40,125);lerJsonBoia();if(boias.length>1){$('#menu_boias .abas_graficos li').each(function(){$(this)[0].className="normal";});$('#boia'+id)[0].className="ativa";}}
function limpaDados(){temVento=false;temOndas=false;temTemp=false;temDir=false;temDirVento=false;temDadosHoje=false;hmax=0.0;vmax=0;tmax=0;nome="";status="";site="";desc="";linkWidth=0;linkHeight=30;linkXini=10;linkYini=30;for(var dd=0;dd<2;dd++){horaBoia[dd]=new Array(25);alturaSig[dd]=new Array(25);alturaMax[dd]=new Array(25);periodoBoia[dd]=new Array(25);direcaoOndas[dd]=new Array(25);vento[dd]=new Array(25);ventoDir[dd]=new Array(25);rajada[dd]=new Array(25);pressao[dd]=new Array(25);artemp[dd]=new Array(25);martemp[dd]=new Array(25);dat[dd]="";for(cc=0;cc<25;cc++){horaBoia[dd][cc]="";alturaSig[dd][cc]="";alturaMax[dd][cc]="";periodoBoia[dd][cc]="";direcaoOndas[dd][cc]="";vento[dd][cc]="";ventoDir[dd][cc]="";rajada[dd][cc]="";pressao[dd][cc]="";artemp[dd][cc]="";martemp[dd][cc]="";xBotao[cc]=0;xBotao[cc+25]=0;}}}
function lerJsonBoia(){var dd=-1,cc=-1;var hh="";var alt=0;limpaDados();$.getJSON('/boias/dados/'+idBoia,function(data){nome=data.boia.nome;status=data.boia.status;site=data.boia.site;descricao=data.boia.descricao;tipoBoia=parseInt(data.boia.tipo);dd=-1;if(tipoBoia==3){$('#siteBoia a').attr("href",site).html("<strong>"+nome+"</strong> (link externo)");$('#quadroBoia').hide();$('#areaBoia').attr("style","width:300px;height:80px;");$('#siteBoia').show();}else{$.each(data.diario,function(i,dadosDia){dd++;cc=0;dat[dd]=dadosDia.data;$.each(dadosDia.leituras,function(i,leituras){hh=leituras.hora;if(hh!="-"){horaBoia[dd][cc]=leituras.hora;alturaSig[dd][cc]=leituras.hs;alturaMax[dd][cc]=leituras.hmax;periodoBoia[dd][cc]=leituras.perPrim;direcaoOndas[dd][cc]=leituras.dirOnda;pressao[dd][cc]=leituras.pressao;artemp[dd][cc]=leituras.artemp;martemp[dd][cc]=leituras.martemp;if(dd==0)temDadosHoje=true;if(alturaSig[dd][cc]!=""&&!isNaN(alturaSig[dd][cc])){if(parseFloat(alturaSig[dd][cc])>0.0)cc++;}}});cc=0;if(!(typeof dadosDia.ventos=="undefined"||!(dadosDia.ventos instanceof Array))){$.each(dadosDia.ventos,function(i,ventos){hh=ventos.hora;if(hh!="-"){vento[dd][cc]=ventos.intVento;if(vento[dd][cc]!=""&&!isNaN(vento[dd][cc]))vento[dd][cc]=Math.round(1.9438*parseFloat(vento[dd][cc]));ventoDir[dd][cc]=ventos.dirVento;rajada[dd][cc]=ventos.rajada;if(vento[dd][cc]!=""&&!isNaN(vento[dd][cc])){if(parseFloat(vento[dd][cc])>0.0)cc++;}}});}});inicializaGraficos();}});}
var hMaxBoia=0.0;function inicializaGraficos(){hmax=0.0;vmax=0;if(status!=1&&boias.length==1){$("#btn-barra2").toggleClass("barra-fechada");$('#conteudo-box2').hide();$('#nome_boia').html("Ond&oacute;grafo: "+boias[0]+" &nbsp; ( <b>"+statusTipo[status]+"</b> )");}
ctx.clearRect(0,0,650,250);for(dd=0;dd<2;dd++){for(cc=0;cc<25;cc++){if(alturaSig[dd][cc]!=""&&!isNaN(alturaSig[dd][cc])){temOndas=true;if(parseFloat(alturaSig[dd][cc])>hmax)hmax=parseFloat(alturaSig[dd][cc]);if(direcaoOndas[dd][cc]!=""&&!isNaN(direcaoOndas[dd][cc]))temDir=true;}
if(vento[dd][cc]!=""&&!isNaN(vento[dd][cc])){temVento=true;if(vento[dd][cc]>vmax)vmax=vento[dd][cc];if(ventoDir[dd][cc]!=""&&!isNaN(ventoDir[dd][cc]))temDirVento=true;}
if(martemp[dd][cc]!=""&&!isNaN(martemp[dd][cc])){temTemp=true;if(martemp[dd][cc]>tmax)tmax=martemp[dd][cc];}}}
if(temOndas){if(!temDirVento&&!temDir)drawRosaApagada();hmax=Math.floor(hmax)+1.0;if(hmax<3.0)hmax=3.0;if(temVento){if(10*hmax>vmax){fatorBoia=(10/hmax);ymax=fatorBoia*hmax*10;}else{fatorBoia=(100/vmax);ymax=fatorBoia*vmax;}}else if(temTemp){tmax=Math.ceil(tmax/10)*10+5;if(10*hmax>tmax){fatorBoia=(10/hmax);ymax=fatorBoia*hmax*10;}else{fatorBoia=(100/tmax);ymax=fatorBoia*tmax;}}else{fatorBoia=(10/hmax);ymax=fatorBoia*hmax*10;}
drawTitulo();hMaxBoia=hmax;if(temDadosHoje)drawLeitura(0,0);else drawLeitura(1,0);plotaGraficoOndas();drawGrafico();if(temVento)plotaGraficoVento();drawEscala();if(temDir||temDirVento){drawSetasLegenda();}}else{ctx.fillStyle="#900";ctx.font="18px verdana";ctx.fillText(nome+" ("+idBoia+") "+desc,30,50);ctx.font="38px verdana";ctx.fillText("N\u00e3o h\u00e1 dados de ondas!",100,150);$('#conteudo-box2').hide();}}
function plotaGraficoOndas(){var hms=new Array(3);var pp=p=x=y=0;for(dd=0;dd<2;dd++){for(cc=0;cc<25;cc++){if(alturaSig[dd][cc]!=""&&!isNaN(alturaSig[dd][cc])){hms=horaBoia[dd][cc].split(":");x=gx+400-Math.round(200*(dd+(24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=gy-Math.round(alturaSig[dd][cc]*10*fatorBoia);if(periodoBoia[dd][cc]!=""&&!isNaN(periodoBoia[dd][cc])){pp=Math.floor(periodoBoia[dd][cc]);if(pp>25)pp=Math.round(pp/10);for(p=0;p<limitePeriodoBoia.length;p++){if(pp<=limitePeriodoBoia[p]){ctx.fillStyle="#"+corPeriodo[p];break;}}}else{ctx.fillStyle="#888";}
ctx.fillRect(x-3,y,6,gy-y-1);xBotao[cc+25*dd]=x-5;}}}}
function plotaGraficoVento(){var hms=new Array(3);var x=y=x0=y0=h0=0;var cont=false;ctx.fillStyle="#33d";ctx.beginPath();ctx.lineWidth=1;for(dd=0;dd<2;dd++){for(cc=0;cc<25;cc++){if(vento[dd][cc]!=""&&!isNaN(vento[dd][cc])){hms=horaBoia[dd][cc].split(":");x=gx+400-Math.round(200*(dd+(24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=gy-vento[dd][cc]*fatorBoia;ctx.strokeStyle="#fff";ctx.strokeRect(x-5,y-5,8,8);ctx.fillRect(x-3,y-3,5,5);if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctx.strokeStyle="#33d";ctx.moveTo(x0,y0);ctx.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}}
ctx.stroke();}
function plotaGraficoTemp(){var hms=new Array(3);var x=y=x0=y0=h0=0;var cont=false;ctx.fillStyle="#d33";ctx.beginPath();ctx.lineWidth=1;for(dd=0;dd<2;dd++){for(cc=0;cc<25;cc++){if(martemp[dd][cc]!=""&&!isNaN(martemp[dd][cc])){hms=horaBoia[dd][cc].split(":");x=gx+400-Math.round(200*(dd+(24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=gy-martemp[dd][cc]*fatorBoia;ctx.strokeStyle="#fff";ctx.strokeRect(x-5,y-5,8,8);ctx.fillRect(x-3,y-3,5,5);if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctx.strokeStyle="#009";ctx.moveTo(x0,y0);ctx.lineTo(x,y);ctx.stroke();}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}}
ctx.stroke();}
function drawGrafico(){var dt=new Date(dat[1]);var dsem=dt.getDay();var ontem=dsem;dsem++;if(dsem>6)dsem=0;var c=0;ctx.beginPath();ctx.strokeStyle="#000";ctx.lineWidth=1;ctx.moveTo(gx-3,gy);ctx.lineTo(gx-3,gy-100);ctx.moveTo(gx-3,gy);ctx.lineTo(gx+403,gy);if(temVento||temTemp)ctx.lineTo(gx+403,gy-100);ctx.stroke();ctx.strokeStyle="#666";ctx.moveTo(gx+50,gy);ctx.lineTo(gx+50,gy-5);ctx.moveTo(gx+100,gy);ctx.lineTo(gx+100,gy-5);ctx.moveTo(gx+150,gy);ctx.lineTo(gx+150,gy-5);ctx.moveTo(gx+200,gy);ctx.lineTo(gx+200,gy-5);ctx.moveTo(gx+250,gy);ctx.lineTo(gx+250,gy-5);ctx.moveTo(gx+300,gy);ctx.lineTo(gx+300,gy-5);ctx.moveTo(gx+350,gy);ctx.lineTo(gx+350,gy-5);ctx.stroke();ctx.font="10px verdana";ctx.fillStyle="#777";ctx.fillText("0h",gx-5,gy+10);ctx.fillText("6h",gx+45,gy+10);ctx.fillText("12h",gx+90,gy+10);ctx.fillText("18h",gx+140,gy+10);ctx.fillText("0h",gx+195,gy+10);ctx.fillText("6h",gx+245,gy+10);ctx.fillText("12h",gx+290,gy+10);ctx.fillText("18h",gx+340,gy+10);ctx.fillText("0h",gx+395,gy+10);ctx.font="12px arial";ctx.fillStyle="#777";ctx.fillText(nomeDiaSem[ontem],gx+85,gy-95);ctx.fillText(nomeDiaSem[dsem],gx+290,gy-95);var strUnid="m ";var fatorUnid=10;var altStep=1;if(unidadeAltura=='f'){fatorUnid=3.28;strUnid="ft";if(hMaxBoia>2)altStep=2;if(hMaxBoia>4)altStep=4;}
ctx.fillStyle="#090";for(c=altStep;c<=100;c+=altStep){if(fatorUnid*fatorBoia*c<80){ctx.fillText(c+",0",gx-23,gy-(fatorUnid*fatorBoia*c)+5);}else break;}
ctx.fillText(strUnid,gx-20,gy-95);if(temVento){ctx.fillStyle="#33d";for(c=10;c<=Math.floor(100/fatorBoia);c+=10){if(fatorBoia*c<100){ctx.fillText(c,gx+405,gy-(fatorBoia*c)+5);}}
ctx.fillText("kt",gx+407,gy-90);}else{ctx.fillStyle="#090";for(c=altStep;c<=100;c+=altStep){if(fatorUnid*fatorBoia*c<80){ctx.fillText(c+",0",gx+405,gy-(fatorUnid*fatorBoia*c)+5);}else break;}
ctx.fillText(strUnid,gx+407,gy-95);}
ctx.strokeStyle="#eee";var step=10;if(unidadeAltura=='f'){step=3.28;if(hMaxBoia>2)step=2*step;if(hMaxBoia>4)step=2*step;}
for(c=step;c<=ymax;c+=step){if(c*fatorBoia<80){ctx.moveTo(gx-3,gy-c*fatorBoia);ctx.lineTo(gx+400,gy-c*fatorBoia);}else break;}
ctx.strokeStyle="#777";ctx.moveTo(gx+200,gy);ctx.lineTo(gx+200,gy-100);ctx.stroke();}
function drawEscala(){var o=4;ctx.font="10px verdana";ctx.fillStyle="#000";ctx.fillText("Periodo (s)",gx-15,gy+23);for(p=0;p<limitePeriodoBoia.length;p++){if(p>4)o=0;ctx.fillStyle="#"+corPeriodo[p];ctx.fillRect(gx+50+22*p,gy+13,22,13);if(p<2||p>limitePeriodoBoia.length-4)ctx.fillStyle="#fff";else ctx.fillStyle="#000";ctx.fillText(limitePeriodoBoia[p],gx+53+o+22*p,gy+23);}}
function lerEstacao(){canvasEstacao=document.getElementById('quadroMet');ctxEstacao=canvasEstacao.getContext('2d');if(idEstacaoTempo.indexOf("|")>0){estacoes=idEstacaoTempo.split("|");$("#menu_estacoes").show();alturaMinEstacao+=30;alturaMaxEstacao+=30;for(var i=0;i<estacoes.length;i++){if(i>1){$('#estacao'+String(i-1)).after($('#estacao1').clone().attr("id","estacao"+i));$('#estacao'+i+' a').attr("href","javascript:mostraEstacao("+i+");");}
$("#estacao"+i+" a").html(estacoes[i]);};}else{estacoes[0]=idEstacaoTempo;}
$('#estacao_display').attr("style","height:"+alturaMinEstacao+"px;").show();mostraEstacao(0);}
function mostraGraficoWeather(){if(!graficos_estacoes){$("#estacao_display").animate({height:alturaMaxEstacao},1000);$('#titulo_botao_estacoes').html("ESCONDER GRÁFICOS DAS LEITURAS DO DIA");$('#seta_titulo_botao_estacoes').html("&#9650;");graficos_estacoes=true;}
else{$("#estacao_display").animate({height:alturaMinEstacao},1000);$('#titulo_botao_estacoes').html("MOSTRAR GRÁFICOS DAS LEITURAS DO DIA");$('#seta_titulo_botao_estacoes').html("&#9660;");graficos_estacoes=false;}}
function mostraEstacao(id){ctxEstacao.clearRect(0,0,620,600);ctxEstacao.fillStyle="#00c";ctxEstacao.font="28px verdana";ctxEstacao.fillText("Aguarde... Carregando dados.",60,55);lerJsonEstacao(id);if(estacoes.length>1){$('#menu_estacoes .abas_graficos li').each(function(){$(this)[0].className="normal";});$('#estacao'+id)[0].className="ativa";}}
function limpaDadosEstacao(){var dd=cc=0;logoObj.src="/img/sprite.png";ctxEstacao.drawImage(logoObj,500,25);linkTextEstacao="";inLinkEstacao=false;fatorEstacao=5;temVentoEstacao=false;temDirVentoEstacao=false;temRajada=false;temTemp=false;temPressao=false;temUmidade=false;temOrvalho=false;temPrecipitacao=false;temRadiacao=false;temIndiceCalor=false;temUv=false;temTempo=false;temIcone=false;pressaoEstacaoPlotada=false;vmaxEstacao=20;gmax=20;tmax=20;pmax=20;omax=0;ppmax=0;rmax=0;imax=0;uvmaxEstacao=0;tmin=1000;pmin=2000;omin=1000;imin=1000;nomeEstacao="";desktopEstacao="";mobileEstacao="";linkEstacao="";alturaMaxEstacao=640;mostraRosaEstacao=false;$("#estacao_display").attr("style","height:"+alturaMinEstacao+"px;").show();$('#titulo_botao_estacoes').html("MOSTRAR GRÁFICOS DAS LEITURAS DO DIA");$('#seta_titulo_botao_estacoes').html("&#9660;");graficos_estacoes=false;for(dd=0;dd<2;dd++){for(cc=0;cc<3;cc++)botao[dd][cc]=0;}
for(dd=0;dd<24;dd++)hBotao[dd]=-1;for(cc=0;cc<25;cc++){horaEstacao[cc]="";ventoEstacao[cc]="";ventoDirEstacao[cc]="";rajadaEstacao[cc]="";orvalho[cc]="";umidade[cc]="";precipitacao[cc]="";radiacao[cc]="";indiceCalor[cc]="";pressaoEstacao[cc]="";artempEstacao[cc]="";uv[cc]="";tempo[cc]="";icone[cc]="";}}
function lerJsonEstacao(e){var dd=-1,cc=-1;limpaDadosEstacao();idEstacao=estacoes[e];$.getJSON("/leituras/dados/"+idEstacao,function(dadosEstacao){nomeEstacao=dadosEstacao.estacao.nome;desktopEstacao=dadosEstacao.estacao.desktop;mobileEstacao=dadosEstacao.estacao.mobile;linkEstacao=dadosEstacao.estacao.link;$.each(dadosEstacao.diario,function(i,dadosDia){cc=-1;datEstacao=dadosDia.data;diasemEstacao=Math.floor(dadosDia.diasem);$.each(dadosDia.leituras,function(i,leituras){cc++;horaEstacao[cc]=leituras.hora;ventoEstacao[cc]=leituras.vento;ventoDirEstacao[cc]=leituras.dirvento;rajadaEstacao[cc]=leituras.rajada;orvalho[cc]=leituras.orvalho;umidade[cc]=leituras.umidade;precipitacao[cc]=leituras.precipitacao;radiacao[cc]=leituras.radiacao;indiceCalor[cc]=leituras.indiceCalor;pressaoEstacao[cc]=leituras.pressao;artempEstacao[cc]=leituras.artemp;uv[cc]=leituras.uv;tempo[cc]=leituras.tempo.trim();icone[cc]=leituras.icone.trim();});});if(horaEstacao[0]!="-"){$('#titulo_estacao').fadeIn(400,function(){$('#estacao_display').fadeIn(400);});}
inicializaGraficosEstacao();});}
function inicializaGraficosEstacao(){var px=py=l=c=lmax=0;hmax=0.0;vmaxEstacao=0;ctxEstacao.clearRect(0,0,650,250);for(cc=0;cc<25;cc++){if(ventoEstacao[cc]!=""&&!isNaN(ventoEstacao[cc])){temVentoEstacao=true;ventoEstacao[cc]=Math.floor(ventoEstacao[cc]);if(ventoEstacao[cc]>vmaxEstacao)vmaxEstacao=ventoEstacao[cc];if(ventoDirEstacao[cc]!=""&&!isNaN(ventoDirEstacao[cc]))temDirVentoEstacao=true;}
if(rajadaEstacao[cc]!=""&&!isNaN(rajadaEstacao[cc])){temRajada=true;rajadaEstacao[cc]=Math.floor(rajadaEstacao[cc]);if(rajadaEstacao[cc]>gmax)gmax=rajadaEstacao[cc];}
if(artempEstacao[cc]!=""&&!isNaN(artempEstacao[cc])){temTemp=true;artempEstacao[cc]=parseFloat(artempEstacao[cc]);if(artempEstacao[cc]>tmax)tmax=artempEstacao[cc];if(artempEstacao[cc]<tmin)tmin=artempEstacao[cc];}
if(pressaoEstacao[cc]!=""&&!isNaN(pressaoEstacao[cc])){temPressao=true;pressaoEstacao[cc]=Math.floor(pressaoEstacao[cc]);if(pressaoEstacao[cc]>pmax)pmax=pressaoEstacao[cc];if(pressaoEstacao[cc]<pmin)pmin=pressaoEstacao[cc];}
if(orvalho[cc]!=""&&!isNaN(orvalho[cc])){temOrvalho=true;orvalho[cc]=parseFloat(orvalho[cc]);if(orvalho[cc]>omax)omax=orvalho[cc];if(orvalho[cc]<omin)omin=orvalho[cc];}
if(indiceCalor[cc]!=""&&!isNaN(indiceCalor[cc])){temIndiceCalor=true;indiceCalor[cc]=parseFloat(indiceCalor[cc]);if(indiceCalor[cc]>imax)imax=indiceCalor[cc];if(indiceCalor[cc]<imin)imin=indiceCalor[cc];}
if(umidade[cc]!=""&&!isNaN(umidade[cc])){temUmidade=true;umidade[cc]=Math.floor(umidade[cc]);}
if(precipitacao[cc]!=""&&!isNaN(precipitacao[cc])){temPrecipitacao=true;precipitacao[cc]=parseFloat(precipitacao[cc]);if(precipitacao[cc]>ppmax)ppmax=precipitacao[cc];}
if(radiacao[cc]!=""&&!isNaN(radiacao[cc])){temRadiacao=true;radiacao[cc]=parseFloat(radiacao[cc]);if(radiacao[cc]>rmax)rmax=radiacao[cc];}
if(uv[cc]!=""&&!isNaN(uv[cc])){temUv=true;uv[cc]=Math.floor(uv[cc]);if(uv[cc]>uvmaxEstacao)uvmaxEstacao=uv[cc];}
if(tempo[cc]!=""&&tempo[cc]!="-"){temTempo=true;}
if(icone[cc]!=""&&icone[cc]!="-"){temIcone=true;}}
var achou=false;px=gxEstacao;py=gyEstacao;if(temVentoEstacao){botao[1][0]=1;plotaGraficoVentoEstacao(gxEstacao+320,gyEstacao);if(temDirVentoEstacao){botao[1][1]=1;lmax=1;plotaGraficoDirVento(gxEstacao+320,gyEstacao+165);}}
if(temTemp){botao[0][0]=1;plotaGraficoTempEstacao(gxEstacao,gyEstacao);}
achou=false;if(temUmidade||temPrecipitacao){for(l=0;l<4;l++){for(c=0;c<2;c++){if(botao[c][l]==0){botao[c][l]=1;px=gxEstacao+c*dxEstacao;py=gyEstacao+l*dyEstacao;lmax=l;achou=true;break;}}
if(achou)break;}
plotaGraficoUmid(px,py);}
achou=false;if(temRadiacao||temUv){for(l=0;l<4;l++){for(c=0;c<2;c++){if(botao[c][l]==0){botao[c][l]=1;px=gxEstacao+c*dxEstacao;py=gyEstacao+l*dyEstacao;lmax=l;achou=true;break;}}
if(achou)break;}
plotaGraficoRadiacao(px,py);}
achou=false;if(temPressao&&!pressaoEstacaoPlotada){for(l=0;l<4;l++){for(c=0;c<2;c++){if(botao[c][l]==0){botao[c][l]=1;px=gxEstacao+c*dxEstacao;py=gyEstacao+l*dyEstacao;lmax=l;achou=true;break;}}
if(achou)break;}
plotaGraficoPressao(px,py);}
canvasEstacao.addEventListener("mousemove",on_mousemoveEstacao,false);canvasEstacao.addEventListener("click",on_clickEstacao,false);alturaMaxEstacao=alturaMinEstacao+(lmax+1)*dyEstacao;drawLeituraEstacao(0);setTimeout(drawLogo,1000);if(temTempo){setTimeout(drawTempo,2000);setTimeout(carregaTempo,3000);}
setTimeout(drawLogo,4000);}
function drawLogo(){ctxEstacao.clearRect(490,0,128,130);if(desktopEstacao==""){var dt=datEstacao.replace("-","/").replace("-","/");logoObj.src=s3bucket+"img/wundergroundDesktop.png";linkEstacao="https://www.wunderground.com/history/station/"+idEstacao+"/"+dt+"/DailyHistory.html";}else{logoObj.src=desktopEstacao;}
ctxEstacao.drawImage(logoObj,500,25);}
function drawTempo(){var tx=lx+5;if(icone[hEstacao]!=""&&icone[hEstacao]!="-"){hms=horaEstacao[hEstacao].split(":");if(hms[0]<6||hms[0]>18)imageObj.src=s3bucket+iconUrl+"nt_"+icone[hEstacao]+".gif";else imageObj.src=s3bucket+iconUrl+icone[hEstacao]+".gif";ctxEstacao.drawImage(imageObj,tx,ly+30);ctxEstacao.fillStyle="#000";ctxEstacao.font="12px verdana";ctxEstacao.fillText(tempo[hEstacao],tx,ly+95);}}
function carregaTempo(){for(var c=1;c<icone.length;c++){if(icone[c]!=""&&icone[c]!="-"){tempoObj[c]=new Image();tempoObj[c].src=s3bucket+iconUrl+icone[c]+".gif";}else{tempoObj[c]=new Image();tempoObj[c].src="/img/sprite.png";}}}
function plotaGraficoVentoEstacao(px,py){var hms=new Array(3);var x=y=x0=y0=h0=0;var cont=false;var c=0;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);if(gmax>vmaxEstacao)vmaxEstacao=gmax;vmaxEstacao=4*(Math.floor(vmaxEstacao/4)+1);fatorEstacao=(100/vmaxEstacao);ymax=fatorEstacao*vmaxEstacao;ctxEstacao.fillStyle="#33d";for(c=1;c<4;c++){ctxEstacao.fillText(vmaxEstacao*(c/4),px-20,py-25*c+3);ctxEstacao.fillText(vmaxEstacao*(c/4),px+246,py-25*c+3);}
ctxEstacao.fillStyle="#000";if(temRajada){ctxEstacao.fillText("Vento e Rajadas",px+75,py-105);ctxEstacao.fillStyle="#33d";ctxEstacao.fillText("vento",px+65,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#33d";ctxEstacao.moveTo(px+35,py+20);ctxEstacao.lineTo(px+62,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#090";ctxEstacao.fillText("rajadas",px+155,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(px+125,py+20);ctxEstacao.lineTo(px+152,py+20);ctxEstacao.stroke();}
else ctxEstacao.fillText("Vento",px+105,py-105);ctxEstacao.fillText("kt",px-20,py-90);ctxEstacao.fillText("kt",px+246,py-90);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();ctxEstacao.fillStyle="#33d";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(ventoEstacao[cc]!=""&&!isNaN(ventoEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-ventoEstacao[cc]*fatorEstacao;hBotao[Math.floor(hms[0])]=true;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#33d";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();if(temRajada){ctxEstacao.beginPath();ctxEstacao.lineWidth=1;ctxEstacao.strokeStyle="#090";for(cc=0;cc<25;cc++){if(rajadaEstacao[cc]!=""&&!isNaN(rajadaEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-rajadaEstacao[cc]*fatorEstacao;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}}
function plotaGraficoDirVento(px,py){var hms=new Array(3);var x=y=x0=y0=h0=0;var cont=false;var c=0;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);ctxEstacao.fillStyle="#000";ctxEstacao.fillText("Dire\u00E7\u00E3o do Vento",px+75,py-105);ctxEstacao.fillStyle="#b33";for(c=0;c<4;c++){ctxEstacao.fillText(dirSiglas[c],px-15,py-25*c+3);ctxEstacao.fillText(90*c+"\u00b0",px+246,py-25*c+3);}
for(cc=0;cc<25;cc++){if(ventoDirEstacao[cc]!=""&&!isNaN(ventoDirEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-Math.floor(ventoDirEstacao[cc]/3.6);ctxEstacao.strokeStyle="#fff";ctxEstacao.strokeRect(x-5,y-5,8,8);ctxEstacao.fillRect(x-3,y-3,5,5);}}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();}
function plotaGraficoTempEstacao(px,py){var hms=new Array(3);var c=d=x=y=x0=y0=ttmax=ttmin=h0=0;var cont=false;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);ttmax=tmax;ttmin=tmin;if(temOrvalho){if(omax>ttmax)ttmax=omax;if(omin<ttmin)ttmin=omin;}
if(temIndiceCalor){if(imax>ttmax)ttmax=imax;if(imin<ttmin)ttmin=imin;}
ttmax=4*(Math.floor(ttmax/4)+1);ttmin=4*(Math.floor(ttmin/4));d=ttmax-ttmin;fatorEstacao=(100/d);ymax=fatorEstacao*ttmax;ctxEstacao.fillStyle="#d33";for(c=0;c<=4;c++){y=ttmin+d*(c/4);if(Math.floor(y)==y){ctxEstacao.fillText(y,px-20,py-25*c+3);ctxEstacao.fillText(y,px+246,py-25*c+3);}}
ctxEstacao.fillStyle="#000";if(temIndiceCalor)ctxEstacao.fillText("Temperatura e \u00CDndice de Calor",px+35,py-105);else if(temOrvalho)ctxEstacao.fillText("Temperatura e Ponto de Orvalho",px+35,py-105);else ctxEstacao.fillText("Temperatura do ar",px+70,py-105);ctxEstacao.fillStyle="#d33";ctxEstacao.fillText("\u00b0C",px+3,py-90);ctxEstacao.fillText("\u00b0C",px+223,py-90);if(temOrvalho||temIndiceCalor){if(temOrvalho&&temIndiceCalor){ctxEstacao.fillText("temperat.",px,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#d33";ctxEstacao.moveTo(px-20,py+20);ctxEstacao.lineTo(px-3,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#090";ctxEstacao.fillText("pt. de orvalho",px+90,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(px+70,py+20);ctxEstacao.lineTo(px+87,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#990";ctxEstacao.fillText("Ind. Calor",px+200,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(px+180,py+20);ctxEstacao.lineTo(px+197,py+20);ctxEstacao.stroke();}else if(temOrvalho){ctxEstacao.fillText("temperatura",px+30,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#d33";ctxEstacao.moveTo(px+10,py+20);ctxEstacao.lineTo(px+27,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#090";ctxEstacao.fillText("ponto de orvalho",px+130,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(px+110,py+20);ctxEstacao.lineTo(px+127,py+20);ctxEstacao.stroke();}else if(temIndiceCalor){ctxEstacao.fillText("temperatura",px+30,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#d33";ctxEstacao.moveTo(px+10,py+20);ctxEstacao.lineTo(px+27,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#990";ctxEstacao.fillText("\u00EDndice de calor",px+130,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(px+110,py+20);ctxEstacao.lineTo(px+127,py+20);ctxEstacao.stroke();}}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();ctxEstacao.fillStyle="#d33";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(artempEstacao[cc]!=""&&!isNaN(artempEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-(artempEstacao[cc]-ttmin)*fatorEstacao;hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#d33";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();if(temOrvalho){ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(orvalho[cc]!=""&&!isNaN(orvalho[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-(orvalho[cc]-ttmin)*fatorEstacao;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#090";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}
if(temIndiceCalor){ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(indiceCalor[cc]!=""&&!isNaN(indiceCalor[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-(indiceCalor[cc]-ttmin)*fatorEstacao;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#990";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}}
function plotaGraficoUmid(px,py){var hms=new Array(3);var c=d=x=y=x0=y0=ttmax=ttmin=h0=0;var cont=false;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);ppmax=4*(Math.floor(ppmax/4)+1);fatorEstacao=(100/ppmax);if(temPrecipitacao&&temUmidade){ctxEstacao.fillStyle="#33b";for(c=1;c<4;c++){ctxEstacao.fillText(25*c,px-20,py-25*c+3);}
ctxEstacao.fillStyle="#000";txt="Umidade e Precipita\u00E7\u00E3o";ctxEstacao.fillText(txt,px+55,py-105);ctxEstacao.fillStyle="#0b0";ctxEstacao.fillText("%",px-20,py-90);ctxEstacao.fillStyle="#33b";for(c=1;c<4;c++){y=ppmax*(c/4);if(Math.floor(y)==y)ctxEstacao.fillText(y,px+246,py-25*c+3);}
ctxEstacao.fillText("mm",px+245,py-90);ctxEstacao.fillStyle="#0b0";ctxEstacao.fillText("umidade",px+30,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#0b0";ctxEstacao.moveTo(px+10,py+20);ctxEstacao.lineTo(px+27,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#33b";ctxEstacao.fillText("precipita\u00E7\u00E3o",px+120,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#33b";ctxEstacao.moveTo(px+100,py+20);ctxEstacao.lineTo(px+117,py+20);ctxEstacao.stroke();}else if(temPrecipitacao){ctxEstacao.fillStyle="#000";if(temPressao){txt="Precipita\u00E7\u00E3o e Press\u00E3o Atmosf\u00E9rica";ctxEstacao.fillText(txt,px+25,py-105);ctxEstacao.fillStyle="#0b0";ctxEstacao.fillText("precipita\u00E7\u00E3o",px+30,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#0b0";ctxEstacao.moveTo(px+10,py+20);ctxEstacao.lineTo(px+27,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#33b";ctxEstacao.fillText("press\u00E3o",px+120,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#33b";ctxEstacao.moveTo(px+100,py+20);ctxEstacao.lineTo(px+117,py+20);ctxEstacao.stroke();}else{txt="Precipita\u00E7\u00E3o";ctxEstacao.fillText(txt,px+85,py-105);}
ctxEstacao.fillStyle="#33b";for(c=1;c<4;c++){y=ppmax*(c/4);if(Math.floor(y)==y){ctxEstacao.fillText(y,px-20,py-25*c+3);if(!temPressao)ctxEstacao.fillText(y,px+246,py-25*c+3);}}
ctxEstacao.fillText("mm",px-26,py-90);if(!temPressao)ctxEstacao.fillText("mm",px+245,py-90);}else if(temUmidade){ctxEstacao.fillStyle="#000";if(temPressao){txt="Umidade e Press\u00E3o Atmosf\u00E9rica";ctxEstacao.fillText(txt,px+35,py-105);ctxEstacao.fillStyle="#0b0";ctxEstacao.fillText("umidade",px+30,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#0b0";ctxEstacao.moveTo(px+10,py+20);ctxEstacao.lineTo(px+27,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#33b";ctxEstacao.fillText("press\u00E3o",px+120,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#33b";ctxEstacao.moveTo(px+100,py+20);ctxEstacao.lineTo(px+117,py+20);ctxEstacao.stroke();}else{txt="Umidade";ctxEstacao.fillText(txt,px+95,py-105);}
ctxEstacao.fillStyle="#0b0";for(c=1;c<4;c++){ctxEstacao.fillText(25*c,px-20,py-25*c+3);if(!temPressao)ctxEstacao.fillText(25*c,px+246,py-25*c+3);}
ctxEstacao.fillText("%",px-20,py-90);if(!temPressao)ctxEstacao.fillText("%",px+246,py-90);}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();if(temPressao&&(!temUmidade||!temPrecipitacao)){ctxEstacao.fillStyle="#00b";ctxEstacao.fillText("mb",px+246,py-90);pmax=8*(Math.floor(pmax/8)+1);pmin=8*(Math.floor(pmin/8));d=pmax-pmin;fatorEstacao2=(100/d);ctxEstacao.font="8px verdana";for(c=0;c<4;c++){y=d*(c/4)+pmin;ctxEstacao.fillText(y,px+245,py-25*c+3);}
ctxEstacao.fillStyle="#00b";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(pressaoEstacao[cc]!=""&&!isNaN(pressaoEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-fatorEstacao2*(pressaoEstacao[cc]-pmin);hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#00b";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();pressaoEstacaoPlotada=true;}
if(temUmidade){ctxEstacao.fillStyle="#0b0";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(umidade[cc]!=""&&!isNaN(umidade[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-umidade[cc];hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#0b0";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}
if(temPrecipitacao){ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(precipitacao[cc]!=""&&!isNaN(precipitacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-precipitacao[cc]*fatorEstacao;hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#33b";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}}
function plotaGraficoRadiacao(px,py){var hms=new Array(3);var c=d=x=y=x0=y0=ttmax=ttmin=h0=0;var cont=false;var fatorEstacao2=0;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);rmax=200*(Math.floor(rmax/200)+1);fatorEstacao=(100/rmax);if(uvmaxEstacao<10)uvmaxEstacao=10;uvmaxEstacao=4*(Math.floor(uvmaxEstacao/4)+1);fatorEstacao2=(100/uvmaxEstacao);ctxEstacao.fillStyle="#000";if(temUv&&temRadiacao){txt="Radia\u00E7\u00E3o Solar e \u00EDndice UV";ctxEstacao.fillText(txt,px+55,py-105);ctxEstacao.fillStyle="#b33";ctxEstacao.fillText("W/m\u00B2",px+3,py-90);for(c=1;c<4;c++){y=rmax*(c/4);ctxEstacao.fillText(y,px-25,py-25*c+3);}
ctxEstacao.fillStyle="#b33";ctxEstacao.fillText("radiacao",px+60,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#b33";ctxEstacao.moveTo(px+40,py+20);ctxEstacao.lineTo(px+57,py+20);ctxEstacao.stroke();ctxEstacao.fillStyle="#990";ctxEstacao.fillText("UV",px+222,py-90);for(c=1;c<4;c++){y=uvmaxEstacao*(c/4);if(Math.floor(y)==y)ctxEstacao.fillText(y,px+246,py-25*c+3);}
ctxEstacao.fillStyle="#990";ctxEstacao.fillText("indice uv",px+150,py+23);ctxEstacao.beginPath();ctxEstacao.strokeStyle="#990";ctxEstacao.moveTo(px+130,py+20);ctxEstacao.lineTo(px+147,py+20);ctxEstacao.stroke();}
else if(temUv){ctxEstacao.fillStyle="#990";txt="\u00EDndice UV";ctxEstacao.fillText(txt,px+85,py-105);ctxEstacao.fillStyle="#990";ctxEstacao.fillText("UV",px+3,py-90);ctxEstacao.fillText("UV",px+223,py-90);for(c=1;c<4;c++){y=uvmaxEstacao*(c/4);if(Math.floor(y)==y){ctxEstacao.fillText(y,px-20,py-25*c+3);ctxEstacao.fillText(y,px+246,py-25*c+3);}}}
else if(temRadiacao){txt="Radia\u00E7\u00E3o Solar";ctxEstacao.fillText(txt,px+75,py-105);ctxEstacao.fillStyle="#b33";ctxEstacao.fillText("W/m\u00B2",px+3,py-90);ctxEstacao.fillText("W/m\u00B2",px+207,py-90);for(c=1;c<4;c++){y=rmax*(c/4);ctxEstacao.fillText(y,px-25,py-25*c+3);ctxEstacao.fillText(y,px+246,py-25*c+3);}}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();if(temRadiacao){ctxEstacao.fillStyle="#990";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(radiacao[cc]!=""&&!isNaN(radiacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-fatorEstacao*radiacao[cc];hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#b00";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}
if(temUv){ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(uv[cc]!=""&&!isNaN(uv[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-uv[cc]*fatorEstacao2;hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#990";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}}
function plotaGraficoPressao(px,py){var hms=new Array(3);var c=d=x=y=x0=y0=ttmax=ttmin=h0=0;var cont=false;var fatorEstacao2=0;ctxEstacao.beginPath();ctxEstacao.strokeStyle="#000";ctxEstacao.lineWidth=1;ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px-3,py-100);ctxEstacao.moveTo(px-3,py);ctxEstacao.lineTo(px+243,py);if(temVentoEstacao)ctxEstacao.lineTo(px+243,py-100);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.strokeStyle="#eee";ctxEstacao.moveTo(px+60,py);ctxEstacao.lineTo(px+60,py-100);ctxEstacao.moveTo(px+120,py);ctxEstacao.lineTo(px+120,py-100);ctxEstacao.moveTo(px+180,py);ctxEstacao.lineTo(px+180,py-100);ctxEstacao.stroke();ctxEstacao.font="10px verdana";ctxEstacao.fillStyle="#777";ctxEstacao.fillText("0h",px-5,py+10);ctxEstacao.fillText("6h",px+55,py+10);ctxEstacao.fillText("12h",px+110,py+10);ctxEstacao.fillText("18h",px+170,py+10);pmax=8*(Math.floor(pmax/8)+1);pmin=8*(Math.floor(pmin/8));d=pmax-pmin;fatorEstacao=(100/d);ctxEstacao.fillStyle="#000";txt="Press\u00E3o Atmosf\u00E9rica";ctxEstacao.fillText(txt,px+55,py-105);ctxEstacao.fillStyle="#b33";ctxEstacao.fillText("mb",px+3,py-90);ctxEstacao.fillText("mb",px+222,py-90);ctxEstacao.font="8px verdana";for(c=0;c<=4;c++){y=d*(c/4)+pmin;ctxEstacao.fillText(y,px+245,py-25*c+3);ctxEstacao.fillText(y,px-25,py-25*c+3);}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#ccc";for(c=1;c<4;c++){ctxEstacao.moveTo(px-3,py-25*c);ctxEstacao.lineTo(px+243,py-25*c);}
ctxEstacao.stroke();ctxEstacao.fillStyle="#00b";ctxEstacao.beginPath();ctxEstacao.lineWidth=1;for(cc=0;cc<25;cc++){if(pressaoEstacao[cc]!=""&&!isNaN(pressaoEstacao[cc])){hms=horaEstacao[cc].split(":");x=px+240-Math.round(240*((24-Math.floor(hms[0])-Math.floor(hms[1])/60)/24));y=py-fatorEstacao*(pressaoEstacao[cc]-pmin);hBotao[Math.floor(hms[0])]=cc;if(cont){if(!(h0>Math.floor(hms[0])+1||(h0<Math.floor(hms[0])&&h0>Math.floor(hms[0])-23))){ctxEstacao.strokeStyle="#b00";ctxEstacao.moveTo(x0,y0);ctxEstacao.lineTo(x,y);}}
x0=x;y0=y;h0=Math.floor(hms[0]);cont=true;}else{cont=false;}}
ctxEstacao.stroke();}
function drawLeituraEstacao(h){var dma=new Array(3);var hms=new Array(3);dma=datEstacao.split("-");var vv="";var tx=lx+5;hEstacao=h;ctxEstacao.clearRect(lx,ly,490,110);ctxEstacao.fillStyle="#eee";ctxEstacao.fillRect(lx,ly+25,490,85);ctxEstacao.font="18px verdana";ctxEstacao.fillStyle="#000";linkWidth=ctxEstacao.measureText(nomeEstacao).width;ctxEstacao.fillText(nomeEstacao,lx-linkWidth+480,ly+18);ctxEstacao.fillStyle="#000";ctxEstacao.font="18px verdana";ctxEstacao.fillStyle="#900";ctxEstacao.fillText("("+diaSem[diasemEstacao]+")",lx+10,ly+18);ctxEstacao.fillText(dma[2]+"/"+nomeMes[Math.floor(dma[1])],lx+80,ly+18);ctxEstacao.fillText(horaEstacao[h].substr(0,5)+"h",lx+150,ly+18);if(temTempo){drawTempo();tx+=58;}
if(temTemp){if(artempEstacao[h]!=""&&!isNaN(artempEstacao[h])){ctxEstacao.fillStyle="#d33";ctxEstacao.font="12px verdana";ctxEstacao.fillText("Temperatura:",tx,ly+45);smt=String(artempEstacao[h]);if(smt.length<3)smt=smt+".0";smt=smt.replace(".",",");ctxEstacao.font="18px verdana";ctxEstacao.fillText(smt+"\u00b0C",tx+20,ly+65);tx+=95;}}else if(temPrecipitacao){if(precipitacao[h]!=""&&!isNaN(precipitacao[h])){ctxEstacao.fillStyle="#009";ctxEstacao.font="12px verdana";ctxEstacao.fillText("Precipita\u00E7\u00E3o:",tx,ly+45);smt=String(precipitacao[h]);ctxEstacao.font="18px verdana";ctxEstacao.fillText(smt+"mm",tx+28,ly+65);tx+=95;}}
if(temUmidade){if(umidade[h]!=""&&!isNaN(umidade[h])){ctxEstacao.fillStyle="#090";ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText("Umidade:",tx,ly+45);else ctxEstacao.fillText("Umidade:",tx+30,ly+45);smt=String(umidade[h]);if(smt.length<2)smt="0"+smt;ctxEstacao.font="18px verdana";if(temTempo)ctxEstacao.fillText(smt+"%",tx+20,ly+65);else ctxEstacao.fillText(smt+"%",tx+50,ly+65);tx+=75;}}else if(temPrecipitacao&&temTemp){if(precipitacao[h]!=""&&!isNaN(precipitacao[h])){ctxEstacao.fillStyle="#009";ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText("Precipita\u00E7\u00E3o:",tx,ly+45);else ctxEstacao.fillText("Precipita\u00E7\u00E3o:",lx+130,ly+45);smt=String(precipitacao[h]);ctxEstacao.font="18px verdana";if(temTempo)ctxEstacao.fillText(smt+"mm",tx,ly+65);else ctxEstacao.fillText(smt+"mm",lx+130,ly+65);tx+=85;}}
if(temPressao){if(pressaoEstacao[h]!=""&&!isNaN(pressaoEstacao[h])){ctxEstacao.fillStyle="#000";ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText("Press\u00E3o:",tx,ly+45);else ctxEstacao.fillText("Press\u00E3o:",lx+5,ly+85);smt=String(pressaoEstacao[h]);ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText(smt+"mb",tx,ly+65);else ctxEstacao.fillText(smt+"mb",lx+5,ly+105);}}else if(temRadiacao){if(radiacao[h]!=""&&!isNaN(radiacao[h])){ctxEstacao.fillStyle="#000";ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText("Radia\u00E7\u00E3o:",tx,ly+45);else ctxEstacao.fillText("Radia\u00E7\u00E3o:",lx+20,ly+85);smt=String(radiacao[h]);ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText(smt+"W/m\u00B2",tx,ly+65);else ctxEstacao.fillText(smt+"W/m\u00B2",lx+20,ly+105);}}
if(temUv){if(uv[h]!=""&&!isNaN(uv[h])){ctxEstacao.fillStyle="#990";ctxEstacao.font="12px verdana";if(temTempo)ctxEstacao.fillText("\u00EDndice UV:",lx+235,ly+85);else ctxEstacao.fillText("\u00EDndice UV:",lx+130,ly+85);smt=String(uv[h]);ctxEstacao.font="16px verdana";if(temTempo)ctxEstacao.fillText(smt+",0",lx+265,ly+102);else ctxEstacao.fillText(smt+",0",lx+160,ly+102);}}
mostraRosaEstacao=!temTempo;if(temVentoEstacao){if(ventoEstacao[h]!=""&&!isNaN(ventoEstacao[h])){ctxEstacao.fillStyle="#33d";ctxEstacao.font="14px verdana";ctxEstacao.fillText("Vento:",lx+325,ly+43);ctxEstacao.font="20px verdana";ctxEstacao.fillText("     n\u00f3s |       \u00b0",lx+325,ly+68);ctxEstacao.font="22px verdana";ctxEstacao.fillText(ventoEstacao[h],lx+325,ly+72);vv=ventoDirEstacao[h];while(vv.length<3)vv="0"+vv;ctxEstacao.fillText(vv,lx+415,ly+72);if(temDirVentoEstacao){if(ventoDirEstacao[h]!=""&&!isNaN(ventoDirEstacao[h])){ctxEstacao.fillStyle="#000";ctxEstacao.font="12px verdana";dir=Math.floor((Math.floor(ventoDirEstacao[h])+11.2)/22.5);ctxEstacao.fillText(direcoes_graficos_extenso[dir],lx+380,ly+43);if(h>0||mostraRosaEstacao){if(mostraRosaEstacao){cxEstacao=270;cyEstacao=62;raioEstacao=25;}else{cxEstacao=560;cyEstacao=67;raioEstacao=40;}
drawRosaEstacao();drawSetaVentoEstacao(Math.floor(ventoDirEstacao[h]));}
if(h==0)drawLogo();}}
if(temRajada){if(rajadaEstacao[h]!=""&&!isNaN(rajadaEstacao[h])){ctxEstacao.fillStyle="#090";ctxEstacao.font="12px verdana";ctxEstacao.fillText("rajadas:",lx+327,ly+93);ctxEstacao.font="22px verdana";ctxEstacao.fillText(rajadaEstacao[h]+" n\u00f3s",lx+383,ly+100);}}}}}
function on_mousemoveEstacao(ev){var x=y=d=h=l=c=0;var inBotao=achou=false;var x0=23;x=relX_Estacao;y=relY_Estacao;if(x>=linkEstacaoXini&&x<=(linkEstacaoXini+linkEstacaoWidth)&&y>linkEstacaoYini&&y<=(linkEstacaoYini+linkEstacaoHeight)){document.body.style.cursor="pointer";inLinkEstacao=true;}else{inLinkEstacao=false;inBotao=false;if(y>140){c=-1;l=-1;h=0;if(x>x0&&x<270)c=0;else if(x>343&&x<590)c=1;if(c>=0){h=Math.floor((x-(dxEstacao*c+x0))/10);if(y>144&&y<245)l=0;else if(y>310&&y<410)l=1;else if(y>475&&y<575)l=2;if(l>=0){if(botao[c][l]==1){inBotao=true;if(hBotao[h]>=0){drawLeituraEstacao(hBotao[h]);document.body.style.cursor="pointer";}}}}}
if(!inBotao){drawLeituraEstacao(0);document.body.style.cursor="";if(!mostraRosaEstacao)drawLogo();}}}
function on_clickEstacao(e){if(inLinkEstacao){window.open(linkEstacao,'_blank');}}
function drawRosaEstacao(){if(mostraRosaEstacao){ctxEstacao.fillStyle="#eee";ctxEstacao.fillRect(cxEstacao-(raioEstacao+25),cyEstacao-(raioEstacao+25)+13,2*(raioEstacao+25),85);}else{ctxEstacao.clearRect(cxEstacao-(raioEstacao+25),cyEstacao-(raioEstacao+55),2*(raioEstacao+23),2*(raioEstacao+40));}
ctxEstacao.beginPath();ctxEstacao.strokeStyle="#666";ctxEstacao.moveTo(cxEstacao-(raioEstacao+10),cyEstacao);ctxEstacao.lineTo(cxEstacao+(raioEstacao+10),cyEstacao);ctxEstacao.moveTo(cxEstacao,cyEstacao-(raioEstacao+10));ctxEstacao.lineTo(cxEstacao,cyEstacao+(raioEstacao+10));ctxEstacao.moveTo(cxEstacao+raioEstacao,cyEstacao);ctxEstacao.strokeStyle="#000";ctxEstacao.arc(cxEstacao,cyEstacao,raioEstacao,0,2*Math.PI,true);ctxEstacao.stroke();ctxEstacao.beginPath();ctxEstacao.arc(cxEstacao,cyEstacao,3,0,2*Math.PI,true);ctxEstacao.fill();ctxEstacao.fillStyle="#000";ctxEstacao.font="14px verdana";ctxEstacao.fillText("N",cxEstacao-4,cyEstacao-(raioEstacao+12));ctxEstacao.font="12px arial";ctxEstacao.fillText("L",cxEstacao+(raioEstacao+10),cyEstacao+5);ctxEstacao.fillText("S",cxEstacao-5,cyEstacao+(raioEstacao+22));ctxEstacao.fillText("O",cxEstacao-(raioEstacao+22),cyEstacao+5);ctxEstacao.font="10px arial";ctxEstacao.fillStyle="#888";ctxEstacao.fillText("NE",cxEstacao+(raioEstacao+2)*Math.cos(45*Math.PI/180),cyEstacao-(raioEstacao+2)*Math.sin(45*Math.PI/180));ctxEstacao.fillText("SO",cxEstacao+(raioEstacao+18)*Math.cos(223*Math.PI/180),cyEstacao-(raioEstacao+18)*Math.sin(223*Math.PI/180));ctxEstacao.fillText("SE",cxEstacao+(raioEstacao+8)*Math.cos(310*Math.PI/180),cyEstacao-(raioEstacao+8)*Math.sin(310*Math.PI/180));ctxEstacao.fillText("NO",cxEstacao+(raioEstacao+12)*Math.cos(142*Math.PI/180),cyEstacao-(raioEstacao+12)*Math.sin(142*Math.PI/180));}
function drawSetaVentoEstacao(ang){var x=cxEstacao;var y=cyEstacao-(raioEstacao-2);var w=10;var h=130;ctxEstacao.save();ctxEstacao.translate(cxEstacao,cyEstacao);ctxEstacao.rotate((Math.PI/180)*ang);ctxEstacao.translate(-cxEstacao,-cyEstacao);ctxEstacao.beginPath();ctxEstacao.moveTo(x-2,y);ctxEstacao.lineTo(x+2,y);ctxEstacao.lineTo(x+2,y+(Math.floor((raioEstacao+4))));ctxEstacao.lineTo(x+8,y+(Math.floor((raioEstacao+4))));ctxEstacao.lineTo(x,y+2*(raioEstacao));ctxEstacao.lineTo(x-8,y+(Math.floor((raioEstacao+4))));ctxEstacao.lineTo(x-2,y+(Math.floor((raioEstacao+4))));ctxEstacao.lineTo(x-2,y);ctxEstacao.fillStyle="#33d";ctxEstacao.fill();ctxEstacao.translate(cxEstacao,cyEstacao);ctxEstacao.rotate((Math.PI/180)*-ang);ctxEstacao.translate(-cxEstacao,-cyEstacao);}
var gxHoraTempo=13;var gyTempo=160;var gyNuvens=20;var separaDias=1.5;var hexa=new Array("0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f");var idTipoTempo="temper";var dyTemper=0;var dyPressao=0;var dyPrecip=0;var maxt,mint;function drawGraficoTempo(id){boltImg.src=s3bucket+"img/bolt.gif";var c,a,h,m,x,y,h0,x0,y0,cx,cy,ang,vv,dy,dt,dd=0;if(id=="pressao"){idTipoTempo="pressao"
tempoTemper=false;tempoPressao=true;$("#aba_tempo_temper")[0].className="normal";$("#aba_tempo_pressao")[0].className="ativa";}else{idTipoTempo="temper"
tempoTemper=true;tempoPressao=false;$("#aba_tempo_temper")[0].className="ativa";$("#aba_tempo_pressao")[0].className="normal";}
ctxTempo.clearRect(0,0,1700,gyTempo+gyNuvens);ctxEscalaTempoEsq.clearRect(0,0,40,gyTempo+gyNuvens);ctxEscalaTempoDir.clearRect(0,0,40,gyTempo+gyNuvens);ctxEscalaTempoEsq.font="10px arial";ctxEscalaTempoEsq.fillStyle="#000";ctxEscalaTempoDir.font="10px arial";ctxEscalaTempoDir.fillStyle="#000";ctxEscalaTempoEsq.fillText("nuvens",7,13);ctxEscalaTempoDir.fillText("nuvens",2,13);for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){dd=d-numAtrasoDadosMeteoro;p="";for(h=1;h<9;h++){if(typeof(dadosNuvens[d])!="undefined"){vv=Math.round((100-dadosNuvens[d][h])/10)+5;if(vv>14){ctxTempo.fillStyle="#99f";}else{ctxTempo.fillStyle="#"+hexa[vv]+hexa[vv]+hexa[vv];}
if(vv<16&&vv>4){ctxTempo.fillRect(Math.round(gxHoraTempo*(h-1)+(8*gxHoraTempo+separaDias)*(dd-1)),0,gxHoraTempo,gyNuvens);}}}}
for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){dd=d-numAtrasoDadosMeteoro;p="";for(h=1;h<9;h++){if(typeof(dadosCape[d])!="undefined"&&dadosCape[d][h]<100&&dadosCape[d][h]>0){if(dadosCape[d][h]>=25){ctxTempo.drawImage(boltImg,Math.round(gxHoraTempo*(h-1)+(8*gxHoraTempo+separaDias)*(dd-1)),gyNuvens);}}}}
if(maxPrecip>0){ctxTempo.fillStyle="#cd7";dy=8;if(maxPrecip>20){maxPrecip=8*Math.ceil(maxPrecip/8);dy=Math.round(gyTempo/maxPrecip);}else{maxPrecip=20;}
dyPrecip=dy;for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){dd=d-numAtrasoDadosMeteoro;p="";for(h=1;h<9;h++){if(typeof(dadosPrecip[d])!="undefined"){p=p+dadosPrecip[d][h]+"|";if(dadosPrecip[d][h]>0){vv=Math.round(dy*dadosPrecip[d][h]);ctxTempo.fillRect(gxHoraTempo*(h-1)+(8*gxHoraTempo+separaDias)*(dd-1),gyTempo+gyNuvens-3-vv,gxHoraTempo,vv);}}}}
ctxEscalaTempoDir.font="12px arial";ctxEscalaTempoDir.fillStyle="#000";for(d=maxPrecip/4;d<maxPrecip;d+=maxPrecip/4){ctxEscalaTempoDir.fillText(d,5,25+gyTempo-dy*d);}
ctxEscalaTempoDir.fillText("mm",3,42);}
ctxEscalaTempoDir.fillStyle="#cd7";ctxEscalaTempoDir.fillRect(10,160,20,20);ctxEscalaTempoDir.font="10px arial";ctxEscalaTempoDir.fillStyle="#000";ctxEscalaTempoDir.fillText("chuva",2,157);ctxEscalaTempoDir.fillText("◄",0,175);if(idTipoTempo=="temper"){if(unidadeAltura=='f'){$('.grauc_tsm').html("°F");maxt=parseInt(24*Math.ceil(Math.round(9*maxTemper)/5+32)/24);mint=parseInt(24*Math.floor(Math.round(9*minTemper)/5+32)/24);}else{$('.grauc_tsm').html("°C");maxt=12*Math.ceil(maxTemper/12);mint=12*Math.floor(minTemper/12);}
if(maxt==mint)maxt+=12;dt=maxt-mint;dy=gyTempo/dt;dyTemper=dy;ctxTempo.beginPath();ctxTempo.strokeStyle="#fff";ctxTempo.lineWidth=2;if(unidadeAltura=='f'){vv=dy*(Math.round(9*dadosTemper[1][1]/5+32)-mint);}else{vv=dy*(dadosTemper[1][1]-mint);}
ctxTempo.moveTo(0,gyNuvens+gyTempo-vv);for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){dd=d-numAtrasoDadosMeteoro;if(dd==1)h0=2;else h0=1;p="";for(h=h0;h<9;h++){if(typeof(dadosTemper[d])!="undefined"){if(unidadeAltura=='f'){vv=dy*(Math.round(9*dadosTemper[d][h]/5+32)-mint);}else{vv=dy*(dadosTemper[d][h]-mint);}
ctxTempo.lineTo(gxHoraTempo*(h-1)+(8*gxHoraTempo+separaDias)*(dd-1),gyNuvens+gyTempo-vv);}}}
ctxTempo.stroke();ctxTempo.lineWidth=1;ctxEscalaTempoEsq.font="12px arial";ctxEscalaTempoEsq.fillStyle="#000";ctxEscalaTempoDir.font="12px arial";ctxEscalaTempoDir.fillStyle="#000";for(d=mint+dt/4;d<maxt;d+=dt/4){vv=dy*(d-mint);ctxEscalaTempoEsq.fillText(String(parseInt(d))+"°",20,gyNuvens+gyTempo-vv+4);}
if(unidadeAltura=='f'){ctxEscalaTempoEsq.fillText("°F",20,40);}else{ctxEscalaTempoEsq.fillText("°C",20,40);}}
if(idTipoTempo=="pressao"){maxPressao=12*Math.ceil(maxPressao/12);minPressao=12*Math.floor(minPressao/12);if(maxPressao==minPressao)maxPressao+=12;dt=maxPressao-minPressao;dy=gyTempo/dt;dyPressao=dy;ctxTempo.beginPath();ctxTempo.strokeStyle="#6ff";ctxTempo.lineWidth=2;vv=dy*(dadosPressao[1][1]-minPressao);ctxTempo.moveTo(0,20+gyTempo-vv);for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){dd=d-numAtrasoDadosMeteoro;if(dd==1)h0=2;else h0=1;p="";for(h=h0;h<9;h++){if(typeof(dadosPressao[d])!="undefined"){vv=dy*(dadosPressao[d][h]-minPressao);ctxTempo.lineTo(gxHoraTempo*(h-1)+(8*gxHoraTempo+separaDias)*(dd-1),gyNuvens+gyTempo-vv);}}}
ctxTempo.stroke();ctxTempo.lineWidth=1;ctxEscalaTempoEsq.font="12px arial";ctxEscalaTempoEsq.fillStyle="#000";ctxEscalaTempoDir.font="12px arial";ctxEscalaTempoDir.fillStyle="#000";for(d=minPressao+dt/4;d<maxPressao;d+=dt/4){vv=dy*(d-minPressao);ctxEscalaTempoEsq.fillText(d,12,20+gyTempo-vv+4);}
ctxEscalaTempoEsq.fillText("mb",12,40);}
ctxTempo.strokeStyle="#bbb";for(d=1;d<4;d++){for(h=1;h<8*maxDias;h++){ctxTempo.beginPath();vv=dy*(d-minTemper);ctxTempo.moveTo(h*gxHoraTempo,gyNuvens+gyTempo-40*d);ctxTempo.lineTo((h+0.5)*gxHoraTempo,gyNuvens+gyTempo-40*d);ctxTempo.stroke();}}}
function on_mousemove_Tempo(ev){var dd=x=y=d=h=0;x=relX_tempo;drawGraficoTempo(idTipoTempo);document.body.style.cursor="pointer";ctxTempo.strokeStyle="#eee";ctxTempo.beginPath();for(h=0;h<gyTempo+gyNuvens;h+=5){ctxTempo.moveTo(x,h);ctxTempo.lineTo(x,h+3);ctxTempo.stroke();}
dd=1+numAtrasoDadosMeteoro+Math.floor(x/(8*gxHoraTempo+separaDias));h=1+Math.floor((x-(dd-1-numAtrasoDadosMeteoro)*(8*gxHoraTempo+separaDias))/gxHoraTempo);if(h>8)h=8;if(typeof(dadosNuvens[dd])!="undefined"&&typeof(dadosNuvens[dd][h])!="undefined"&&dadosNuvens[dd][h]<=100&&dadosNuvens[dd][h]>=0){ctxTempo.fillStyle="#fff";ctxTempo.fillRect(x-15,0,30,20);ctxTempo.font="10px arial";ctxTempo.fillStyle="#000";if(dadosNuvens[dd][h]<100){ctxTempo.fillText(dadosNuvens[dd][h]+"%",x-12,12);}else{ctxTempo.fillText("100%",x-15,12);}}
if(typeof(dadosCape[dd])!="undefined"&&dadosCape[dd][h]<=100&&dadosCape[dd][h]>0){ctxTempo.fillStyle="#fff";ctxTempo.fillRect(x-15,gyNuvens+3,30,20);ctxTempo.font="10px arial";ctxTempo.fillStyle="#000";ctxTempo.fillText("cape:",x-12,12+gyNuvens);ctxTempo.fillText(100*dadosCape[dd][h],x-12,22+gyNuvens);}
if(idTipoTempo=="temper"){if(typeof(dadosTemper[dd])!="undefined"){ctxTempo.fillStyle="#fff";if(unidadeAltura=='f'){y=gyTempo+gyNuvens-dyTemper*(Math.round(9*dadosTemper[dd][h]/5+32)-mint);}else{y=gyTempo+gyNuvens-dyTemper*(dadosTemper[dd][h]-mint);}
ctxTempo.fillRect(x-15,y-10,30,15);ctxTempo.font="10px arial";ctxTempo.fillStyle="#000";if(unidadeAltura=='f'){ctxTempo.fillText(String(Math.round(9*dadosTemper[dd][h]/5+32))+"°F",x-12,y+2);}else{ctxTempo.fillText(dadosTemper[dd][h]+"°C",x-12,y+2);}}}else{if(typeof(dadosPressao[dd])!="undefined"){ctxTempo.fillStyle="#fff";y=gyTempo+gyNuvens-dyPressao*(dadosPressao[dd][h]-minPressao);ctxTempo.fillRect(x-15,y-10,45,15);ctxTempo.font="10px arial";ctxTempo.fillStyle="#000";ctxTempo.fillText(dadosPressao[dd][h]+" mb",x-15,y+2);}}
if(maxPrecip>0){if(typeof(dadosPrecip[dd])!="undefined"&&dadosPrecip[dd][h]>0){ctxTempo.fillStyle="#fff";y=gyTempo+gyNuvens-3-Math.round(dyPrecip*dadosPrecip[dd][h]);ctxTempo.fillRect(x-15,y-10,35,17);ctxTempo.font="10px arial";ctxTempo.fillStyle="#000";ctxTempo.fillText(dadosPrecip[dd][h]+"mm",x-13,y);}}}
function posicionaDadosOndas(d,h){var unid="";var strUnid="m";var strAltura=0;var tipoDir="";var intervalo=3;var altura,periodo,direcao,dir,vv;altura=periodo=direcao=dir=0;var pos,aa;pos=55+Math.floor(105.5*(d-1))+13*(h-1)+graficos_dx*xScrollPos;if(pos>320)pos-=280;$("#dados_ondas").attr("style","left:"+pos+"px;");pos=5+parseInt(106*(d-1))+13*(h-1);$("#linha_ondas").attr("style","left:"+pos+"px;height:"+altura_display_ondas+"px;");$("#dados_ondas #data").html(rotuloDia[d]);$("#dados_ondas #hora").html(" &nbsp; "+String(intervalo*(h-1))+":00 h");unid=unidadesVentoSigla[unid_vento];vv=dadosVento[d+numAtrasoDados][h];direcao=dadosDirVento[d+numAtrasoDados][h];altura=String(parseInt(unidadesRazao[unid_vento]*vv))+" "+unid;dir=parseInt((direcao+11.25)/22.5);$("#dados_ondas #vento_int").html(altura);$("#dados_ondas #vento_dir").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");if(mostraSurf){if(unidadeAltura=='m')strAltura=dadosSurf[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosSurf[d+numAtrasoDados][h]/3.03);altura=dadosSurf[d+numAtrasoDados][h]/10;}else{if(unidadeAltura=='m')strAltura=dadosAltura[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosAltura[d+numAtrasoDados][h]/3.03);altura=dadosAltura[d+numAtrasoDados][h]/10;}
periodo=dadosPeriodo[d+numAtrasoDados][h]/10;direcao=dadosDirPrim[d+numAtrasoDados][h];dir=parseInt((direcao+11.25)/22.5);if(unidadeAltura=='f')strUnid="pes";else strUnid="m";$("#dados_ondas #tot_alt").html(strAltura+" "+strUnid);$("#dados_ondas #tot_per").html(periodo+" s");$("#dados_ondas #tot_dir").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");if(idTipo!=0){aa=altura_display_ondas-5-10*fator*altura;$("#linha_ondas #marcadorTotal").attr("style","top:"+aa+"px;");}else{$("#linha_ondas #marcadorTotal").hide();}
if(mostraSurf){if(unidadeAltura=='m')strAltura=dadosVagasSurf[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosVagasSurf[d+numAtrasoDados][h]/3.03);altura=dadosVagasSurf[d+numAtrasoDados][h]/10;}else{if(unidadeAltura=='m')strAltura=dadosVagas[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosVagas[d+numAtrasoDados][h]/3.03);altura=dadosVagas[d+numAtrasoDados][h]/10;}
if(altura>0.1){periodo=dadosPerVag[d+numAtrasoDados][h]/10;direcao=dadosDirVag[d+numAtrasoDados][h];dir=parseInt((direcao+11.25)/22.5);$("#dados_ondas #vag_alt").html(strAltura+" "+strUnid);$("#dados_ondas #vag_per").html(periodo+" s");$("#dados_ondas #vag_dir").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");if(idTipo!=1){aa=altura_display_ondas-5-10*fator*altura;$("#linha_ondas #marcadorVagas").show().attr("style","top:"+aa+"px;");}else{$("#linha_ondas #marcadorVagas").hide();}}else{$("#dados_ondas #vag_alt").html("");$("#dados_ondas #vag_per").html("");$("#dados_ondas #vag_dir").html("");$("#linha_ondas #marcadorVagas").hide();}
if(mostraSurf){if(unidadeAltura=='m')strAltura=dadosSulSurf[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosSulSurf[d+numAtrasoDados][h]/3.03);altura=dadosSulSurf[d+numAtrasoDados][h]/10;}else{if(unidadeAltura=='m')strAltura=dadosSul[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosSul[d+numAtrasoDados][h]/3.03);altura=dadosSul[d+numAtrasoDados][h]/10;}
if(altura>0.1){periodo=dadosPerSul[d+numAtrasoDados][h]/10;direcao=dadosDirSul[d+numAtrasoDados][h];dir=parseInt((direcao+11.25)/22.5);$("#dados_ondas #sws_alt").html(strAltura+" "+strUnid);$("#dados_ondas #sws_per").html(periodo+" s");$("#dados_ondas #sws_dir").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");if(idTipo!=2){aa=altura_display_ondas-5-10*fator*altura;$("#linha_ondas #marcadorSws").show().attr("style","top:"+aa+"px;");}else{$("#linha_ondas #marcadorSws").hide();}}else{$("#dados_ondas #sws_alt").html("");$("#dados_ondas #sws_per").html("");$("#dados_ondas #sws_dir").html("");$("#linha_ondas #marcadorSws").hide();}
if(mostraSurf){if(unidadeAltura=='m')strAltura=dadosNorteSurf[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosNorteSurf[d+numAtrasoDados][h]/3.03);altura=dadosNorteSurf[d+numAtrasoDados][h]/10;}else{if(unidadeAltura=='m')strAltura=dadosNorte[d+numAtrasoDados][h]/10;else strAltura=Math.round(dadosNorte[d+numAtrasoDados][h]/3.03);altura=dadosNorte[d+numAtrasoDados][h]/10;}
if(altura>0.1){periodo=dadosPerNorte[d+numAtrasoDados][h]/10;direcao=dadosDirNorte[d+numAtrasoDados][h];dir=parseInt((direcao+11.25)/22.5);$("#dados_ondas #swn_alt").html(strAltura+" "+strUnid);$("#dados_ondas #swn_per").html(periodo+" s");$("#dados_ondas #swn_dir").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");if(idTipo!=3){aa=altura_display_ondas-5-10*fator*altura;$("#linha_ondas #marcadorSwn").show().attr("style","top:"+aa+"px;");}else{$("#linha_ondas #marcadorSwn").hide();}}else{$("#dados_ondas #swn_alt").html("");$("#dados_ondas #swn_per").html("");$("#dados_ondas #swn_dir").html("");$("#linha_ondas #marcadorSwn").hide();}}
function apagaDadosOndas(){$("#dados_ondas").hide();$("#linha_ondas").hide();}
function posicionaDadosEnergia(d,h){var vv=0;var unid="";var strAltura=0;var tipoDir="";var intervalo=3;var energia,potencia,direcao,dir,vv,strAltura,strPotencia;altura=periodo=direcao=dir=0;var pos,aa;pos=55+Math.floor(105.5*(d-1))+13*(h-1)+graficos_dx*xScrollPos;if(pos>320)pos-=280;$("#dados_energia").attr("style","left:"+pos+"px;");pos=5+parseInt(106*(d-1))+13*(h-1);$("#linha_energia").attr("style","left:"+pos+"px;height:"+altura_display_energia+"px;");$("#dados_energia #data").html(rotuloDia[d]);$("#dados_energia #hora").html(" &nbsp; "+String(intervalo*(h-1))+":00 h");energia=dadosEnTot[d+numAtrasoDados][h];strAltura=String(energia);strAltura=strAltura.replace(".",",");potencia=dadosPoTot[d+numAtrasoDados][h]/10;if(potencia>10)potencia=Math.round(potencia);else potencia=Math.round(100*potencia)/100;strPotencia=String(potencia);strPotencia=strPotencia.replace(".",",");$("#tot_ener").html(strAltura+" Joules");$("#tot_pot").html(strPotencia+" kWatts");if(idTipo!=0){if(mostraEnergia){aa=parseInt(altura_display_energia-5-5*fator*energia/stepEnergia);}else{aa=parseInt(altura_display_energia-5-50*fator*potencia/(20*stepPotencia));}
$("#linha_energia #marcadorTotalEnergia").attr("style","top:"+aa+"px;");}else{$("#linha_energia #marcadorTotalEnergia").hide();}
energia=dadosEnVagas[d+numAtrasoDados][h];strAltura=String(energia);strAltura=strAltura.replace(".",",");potencia=dadosPoVagas[d+numAtrasoDados][h]/10;if(potencia>10)potencia=Math.round(potencia);else potencia=Math.round(100*potencia)/100;strPotencia=String(potencia);strPotencia=strPotencia.replace(".",",");if(mostraEnergia)vv=energia;else vv=potencia;if(vv>0){$("#vag_ener").html(strAltura+" Joules");$("#vag_pot").html(strPotencia+" kWatts");if(idTipo!=1){if(mostraEnergia){aa=parseInt(altura_display_energia-5-5*fator*energia/stepEnergia);}else{aa=parseInt(altura_display_energia-5-50*fator*potencia/(20*stepPotencia));}
$("#linha_energia #marcadorVagasEnergia").show().attr("style","top:"+aa+"px;");}else{$("#linha_energia #marcadorVagasEnergia").hide();}}else{$("#vag_ener").html("");$("#vag_pot").html("");$("#linha_energia #marcadorVagasEnergia").hide();}
energia=dadosEnSul[d+numAtrasoDados][h];strAltura=String(energia);strAltura=strAltura.replace(".",",");potencia=dadosPoSul[d+numAtrasoDados][h]/10;if(potencia>10)potencia=Math.round(potencia);else potencia=Math.round(100*potencia)/100;strPotencia=String(potencia);strPotencia=strPotencia.replace(".",",");if(mostraEnergia)vv=energia;else vv=potencia;if(vv>0){$("#sws_ener").html(strAltura+" Joules");$("#sws_pot").html(strPotencia+" kWatts");if(idTipo!=2){if(mostraEnergia){aa=parseInt(altura_display_energia-5-5*fator*energia/stepEnergia);}else{aa=parseInt(altura_display_energia-5-50*fator*potencia/(20*stepPotencia));}
$("#linha_energia #marcadorSwsEnergia").show().attr("style","top:"+aa+"px;");}else{$("#linha_energia #marcadorSwsEnergia").hide();}}else{$("#sws_ener").html("");$("#sws_pot").html("");$("#linha_energia #marcadorSwsEnergia").hide();}
energia=dadosEnNorte[d+numAtrasoDados][h];strAltura=String(energia);strAltura=strAltura.replace(".",",");potencia=dadosPoNorte[d+numAtrasoDados][h]/10;if(potencia>10)potencia=Math.round(potencia);else potencia=Math.round(100*potencia)/100;strPotencia=String(potencia);strPotencia=strPotencia.replace(".",",");if(mostraEnergia)vv=energia;else vv=potencia;if(vv>0){$("#swn_ener").html(strAltura+" Joules");$("#swn_pot").html(strPotencia+" kWatts");if(idTipo!=3){if(mostraEnergia){aa=parseInt(altura_display_energia-5-5*fator*energia/stepEnergia);}else{aa=parseInt(altura_display_energia-5-50*fator*potencia/(20*stepPotencia));}
$("#linha_energia #marcadorSwnEnergia").show().attr("style","top:"+aa+"px;");}else{$("#linha_energia #marcadorSwnEnergia").hide();}}else{$("#swn_ener").html("");$("#swn_pot").html("");$("#linha_energia #marcadorSwnEnergia").hide();}}
function apagaDadosEnergia(){$("#dados_energia").hide();$("#linha_energia").hide();}
function ajustaEscalaEnergia(){stepEnergia=200;for(var c=2;c<17;c++){$("#coren"+String(c+1)).html(stepEnergia*c/1000);}
$("#coren2").html(String(stepEnergia/1000)+"-");$("#coren18").html(String(stepEnergia*18/1000)+"+");for(var c=1;c<10;c++){$("#escala_en1_"+String(c)).html(stepEnergia*c);$("#escala_en2_"+String(c)).html(stepEnergia*c);}}
function zoom(){var z=6;var noPointer=true;if(mapaNome.length>0){$('#box-mapas').fadeIn(1000);xImagemAtmos=-(imagem_atual-1+2*offsetMapaAtualizacaoAtmos)*comprMapa;xImagemZoomAtmos=-(imagem_atual-1+2*offsetMapaZoomAtualizacaoAtmos)*comprMapa;xImagem=-(imagem_atual-1+2*offsetMapaAtualizacao)*comprMapa;xImagemBr=-(imagem_atual-1+2*offsetMapaZoomAtualizacao)*comprMapa;yImagem=-(tipoImagem-1)*alturaMapa;load(tipoImagem);}}
function selecionaAba3(aba){var seleciona=false;$('.mapa-previsao .abas2 li').each(function(){$(this)[0].className="normal";});$('#b'+aba)[0].className="ativa";if(variavelAtiva==0){variavelAtiva=1;seleciona=true;}
switch(aba){case 'sul':particaoAtiva=1;if(variavelAtiva==1){v='altsul';}else{v='persul';}break;case 'norte':particaoAtiva=2;if(variavelAtiva==1){v='altnorte';}else{v='pernorte';}break;case 'vagas':particaoAtiva=0;if(variavelAtiva==1){v='altvagas';}else{v='pervagas';}break;}
if(seleciona)selecionaTipo(1);switch(v){case 'altsul':tipoImagem2=4;xEscala2=0;break;case 'persul':tipoImagem2=5;xEscala2=-40;break;case 'altnorte':tipoImagem2=6;xEscala2=0;break;case 'pernorte':tipoImagem2=7;xEscala2=-40;break;case 'altvagas':tipoImagem2=8;xEscala2=0;break;case 'pervagas':tipoImagem2=9;xEscala2=-40;break;}
$(".titulo_mapa_previsao2").hide();$('#titulo_'+v).show();if(xEscala2==0&&unidadeAltura=='f')xEscala2=-120;$('#escala_secundaria .escalas').attr("style","left:"+xEscala2+"px;");}
function selecionaAba2(aba){$('.mapa-previsao .abas2 li').each(function(){$(this)[0].className="normal";});$('#b'+aba)[0].className="ativa";$(".titulo_mapa_previsao2").hide();$('#titulo_'+aba).show();switch(aba){case 'altsul':tipoImagem2=4;xEscala2=0;break;case 'persul':tipoImagem2=5;xEscala2=-40;break;case 'altnorte':tipoImagem2=6;xEscala2=0;break;case 'pernorte':tipoImagem2=7;xEscala2=-40;break;case 'altvagas':tipoImagem2=8;xEscala2=0;break;case 'pervagas':tipoImagem2=9;xEscala2=-40;break;}
if(xEscala2==0&&unidadeAltura=='f')xEscala2=-120;$('#escala_secundaria .escalas').attr("style","left:"+xEscala2+"px;");}
function goloop(){var img_Atual=1;if(liga){var Max;if(tipoImagem<4){Max=maxImagens-2*offsetMapaAtualizacao;if(pro)img_Atual=imagem_atual+1;else img_Atual=imagem_atual+0.5;if(img_Atual>Max)img_Atual=1;xScrollPos=Math.round(extensao*(img_Atual-1)/maxImagens);moveGraficos();if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}}
else if(tipoImagem==4){Max=6;dia_atual++;if(dia_atual>Max){dia_atual=1}
selec(2*dia_atual);}
t=setTimeout("goloop();",1000);}}
function play_stop(){liga=!liga;if(liga){goloop();document.play_stop_botao.src=stopSrc.src;}
else{document.play_stop_botao.src=playSrc.src;}}
var particaoAtiva=0;var variavelAtiva=1;function selecionaTipo(aba){var v,xEscala2=0;$('#menu_espectro li a').each(function(){$(this)[0].className="normal";});$('.abas2 li').each(function(){$(this)[0].className="normal";});switch(aba){case 0:$('#b1espectro a')[0].className="ativo";$("#mapa_zoom").hide();$("#espectro_praia").show();$("#escala_secundaria").hide();variavelAtiva=0;break;case 1:$('#b1altura a')[0].className="ativo";$("#mapa_zoom").show();$("#espectro_praia").hide();$("#escala_secundaria").show();switch(particaoAtiva){case 0:v='altvagas';break;case 1:v='altsul';break;case 2:v='altnorte';break;}
variavelAtiva=1;break;case 2:$('#b1periodo a')[0].className="ativo";$("#mapa_zoom").show();$("#espectro_praia").hide();$("#escala_secundaria").show();switch(particaoAtiva){case 0:v='pervagas';break;case 1:v='persul';break;case 2:v='pernorte';break;}
variavelAtiva=2;break;}
$(".titulo_mapa_previsao2").hide();if(variavelAtiva>0){switch(particaoAtiva){case 0:$('#bvagas')[0].className="ativa";break;case 1:$('#bsul')[0].className="ativa";break;case 2:$('#bnorte')[0].className="ativa";break;}
switch(v){case 'altsul':tipoImagem2=4;xEscala2=0;break;case 'persul':tipoImagem2=5;xEscala2=-40;break;case 'altnorte':tipoImagem2=6;xEscala2=0;break;case 'pernorte':tipoImagem2=7;xEscala2=-40;break;case 'altvagas':tipoImagem2=8;xEscala2=0;break;case 'pervagas':tipoImagem2=9;xEscala2=-40;break;}
$('#titulo_'+v).show();$("#arrudeia_escala_espectro").hide();$("#simbolos_espectro").hide();}else{$('#titulo_espectro').show();$("#arrudeia_escala_espectro").show();$("#simbolos_espectro").show();}
if(xEscala2==0&&unidadeAltura=='f')xEscala2=-120;$('#escala_secundaria .escalas').attr("style","left:"+xEscala2+"px;");}
function mostraUnid(un){var objeto3,objeto4="";var totalHoras=8;var vv=0.0;var intervalo=3;var compl="width:11px;margin:0 1px;";if(previsaoAntiga){totalHoras=4;intervalo=6;compl="width:"+larg+"px;";}
$("li[id^='aba_unid_']").each(function(c){$(this)[0].className="normal";});$('#aba_unid_'+un)[0].className="ativa";for(var c=0;c<unidadesVento.length;c++){if(unidadesVento[c]==un){idUnidVento=c;break;}}
unid=unidadesVentoSigla[idUnidVento];if(idUnidVento==1&&!ajusteKmH){var alt=$('#conteudo_esquerdo_previsao').height();alt=alt+parseInt(5*(unidadesRazao[idUnidVento]-1)*maxVento);ajusteKmH=true;}
$('#vento_display .unid_escala').html(unid);$('#vento_display .unid_escala2').html(unid);var mv=parseInt(5*unidadesRazao[idUnidVento]*maxVento);if(mv<180)mv=180;unid_vento=idUnidVento;mostraValoresMeteoro();}
function ajustaAlturaOndas(maxOndas){altura_display_ondas=parseInt(fator*maxOndas+25);$("div[id^='altura_dia']").each(function(){$(this).attr("style","height:"+String(altura_display_ondas)+"px;");});$('#altura_display .envoltorio_graficos').attr("style","height:"+String(altura_display_ondas+70)+"px;");$('#altura_display .envoltorio_escala_lateral').attr("style","height:"+String(altura_display_ondas+25)+"px;");$('#altura_display .envoltorio_escala').attr("style","height:"+String(altura_display_ondas-5)+"px;");$('#altura_display').attr("style","height:"+String(altura_display_ondas+140)+"px;");}
var limitesPotencia=new Array(1,2,3,4,5,7,10,14,20,30,45,70,100,150,200,300,500);var limitesEnergia=new Array(200,300,450,700,1000,1500,2200,3500,5000,8000,12000,17000,25000,40000,60000,90000,140000);var stepPotencia=2;var fatorPotencia=12.5;function ajustaAlturaPotencia(){var ajustaEscala=true;if(max_potencia>12800){fatorPotencia=0.078125;}
else if(max_potencia>6400){fatorPotencia=0.15625;}
else if(max_potencia>3200){fatorPotencia=0.3125;}
else if(max_potencia>1600){fatorPotencia=0.625;}
else if(max_potencia>800){fatorPotencia=1.25;}
else if(max_potencia>400){fatorPotencia=2.5;}
else if(max_potencia>200){fatorPotencia=5;}
else{ajustaEscala=false;}
if(ajustaEscala){stepPotencia=12.5/fatorPotencia;for(var c=2;c<17;c++){$("#corpot"+String(c+1)).html(String(Math.round(stepPotencia*c)));}
$("#corpot2").html(String(Math.round(stepPotencia))+"-");$("#corpot18").html(String(Math.round(stepPotencia*18))+"+");for(var c=1;c<8;c++){$("#escala_pot1_"+String(c)).html(String(Math.round(2*stepPotencia*c)));$("#escala_pot2_"+String(c)).html(String(Math.round(2*stepPotencia*c)));}}}
var fatorEnergia=0.05;var stepEnergia=500;function ajustaAlturaEnergia(){if(max_energia>48000){fatorEnergia=0.0015625;}
else if(max_energia>24000){fatorEnergia=0.003125;}
else if(max_energia>12000){fatorEnergia=0.00625;}
else if(max_energia>6000){fatorEnergia=0.0125;}
else if(max_energia>3000){fatorEnergia=0.025;}
else if(max_energia>2000){fatorEnergia=0.05;}
else{fatorEnergia=0.00078125;}
stepEnergia=25/fatorEnergia;var nCont=0;if(max_energia<=2000){for(var c=1;c<10;c++){$("#escala_en2_"+String(c)).html(Math.round(stepEnergia*c*10)/10);$("#escala_en1_"+String(c)).html(Math.round(stepEnergia*c*10)/10);}
for(var c=2;c<17;c++){$("#coren"+String(c+1)).html(Math.round(stepEnergia*c/100)/10);}
$("#coren2").html(String(Math.round(stepEnergia/100)/10)+"-");$("#coren18").html(String(Math.round(stepEnergia*18/100)/10)+"+");}else{for(nCont=1;nCont<=7;nCont++){$('#escala_en2_'+nCont).html(stepEnergia*nCont);$('#escala_en1_'+nCont).html(stepEnergia*nCont);}}}
function mostraEnergiaPotencia(id){if(id==0){mostraEnergia=true;$("#aba_energia_0 a")[0].className="ativo";$("#aba_energia_1 a")[0].className="normal";}else{mostraEnergia=false;$("#aba_energia_1 a")[0].className="ativo";$("#aba_energia_0 a")[0].className="normal";}
mostraValoresOceano();if(mostraEnergia){$('#letreiro_energia').html("Energia das ondas em Joules/m²");$('.num_escala_energia').show();$('.num_escala_energia2').hide();$('.unid_escala').show();$('.unid_escala2').hide();$('#escala_horizontal_potencia').show();$('#escala_horizontal_energia').hide();}else{$('#letreiro_energia').html("Potência das ondas Kilowatts/m");$('.num_escala_energia').hide();$('.num_escala_energia2').show();$('.unid_escala').hide();$('.unid_escala2').show();$('#escala_horizontal_energia').show();$('#escala_horizontal_potencia').hide();}}
function setEscala(unidade){if(unidadeAltura!=unidade){unidadeAltura=unidade;if(unidade=='m'){idUnidVento=1;$('#botao_unidade_f')[0].className="btn-previsao margem_4px_0";$('#botao_unidade_m')[0].className="btn-previsao-selecionado margem_4px_00_10px";$('#titulo_altura').html("Altura Total das Ondas (em metros)");$('#titulo_vento').html("Velocidade Média do Vento (km/h)");$('#escala_metros').show();$('#escala_metros2').show();$('#escala_metros3').show();$('#escala_pes').hide();$('#escala_pes2').hide();$('#escala_pes3').hide();if(tipoImagem==1){$('#escalas_primarias').show().attr("style","left:0;");}else if(tipoImagem==3){$('#escalas_primarias').show().attr("style","left:-280px;");}
mostraUnid('kmh');}else{idUnidVento=0;$('#botao_unidade_m')[0].className="btn-previsao margem_4px_00_10px";$('#botao_unidade_f')[0].className="btn-previsao-selecionado margem_4px_0";$('#titulo_altura').html("Altura Total das Ondas (em p&eacute;s)");$('#titulo_vento').html("Velocidade Média do Vento (nós)");$('#escala_metros').hide();$('#escala_metros2').hide();$('#escala_metros3').hide();$('#escala_pes').show();$('#escala_pes2').show();$('#escala_pes3').show();if(tipoImagem==1){$('#escalas_primarias').show().attr("style","left:-120px;");}else if(tipoImagem==3){$('#escalas_primarias').show().attr("style","left:-80px;");}
mostraUnid('nos');}
hora_atual--;if(hora_atual<0)hora_atual=0;drawEspectro(parseInt((imagem_atual-1)/2)+1,imagem_atual-2*(dia_atual-1)-1);if(tipoImagem==1)load(1);if(estacaoMare!="-"){mudaTipoPrevisaoMare();$('#link_tabela_mares').attr("href","/previsao/mare/"+idEstacaoMare+"/"+unidadeAltura);}
if(boia!=""&&boia!="0")lerJsonBoia();if(tsm<100){setLeituraTsm();}}
selec(imagem_atual);}
var pressaoLigada=false;function ligaPressao(){if(pressaoLigada){$('#aba_pressao a')[0].className="normal";$('#mapas_pressao_pais').hide();$('#mapas_pressao_regiao').hide();}else{$('#aba_pressao a')[0].className="ativo";$('#mapas_pressao_pais').show();$('#mapas_pressao_regiao').show();}
pressaoLigada=!pressaoLigada;}
function load(t){xScrollPos=$("#scroll_mapas .dragger").position().left;tipoImagem=t;if(mapaZoomAtualizacao!=0)imgDiaZoom=mapaZoomAtualizacao;xImagemBr=-(imagem_atual-1+2*numAtrasoZoom+offsetOceano)*comprMapa;var Max=7;if(t<3){$('#dataHoraMapa').show();$('#dataHoraMapaZoom').show();$('#tsm_display_mapas').hide();$('#area_botoes_mapas').show();$('.envoltorio_scroll').show();xEscala=-(t-1)*40;yImagem=-(t-1)*alturaMapa;yImagemBr=-(t-1)*alturaMapa;if(t==1&&unidadeAltura=='f'){xEscala=-120;yImagem=-3*alturaMapa;}
$('#escalas_primarias').show().attr("style","left:"+xEscala+"px;");$('#mapas_oceano_regiao').show();$('#mapas_oceano_pais').show();$('#mapas_atmos_regiao').hide();$('#mapas_atmos_pais').hide();$('#imagem_mapa_tsm').hide();$('#imagem_mapa_tsm_pais').hide();Max=maxImagens;$("#botao_dia"+dia_atual+" .seta"+idHora[imagem_atual-2*(dia_atual-1)]).show();}else if(t<5){$('#dataHoraMapa').show();$('#dataHoraMapaZoom').show();$('#mapas_oceano_regiao').hide();$('#mapas_oceano_pais').hide();$('#imagem_mapa_tsm').hide();$('#imagem_mapa_tsm_pais').hide();$('#tsm_display_mapas').hide();$('#area_botoes_mapas').show();$('.envoltorio_scroll').show();if(t==3){if(unidadeAltura=='f'){xEscala=-80;yImagem=-3*alturaMapa;}else{xEscala=-280;yImagem=-1*alturaMapa;}}else{xEscala=-240;}
$('#escalas_primarias').show().attr("style","left:"+xEscala+"px;");$('#mapas_atmos_regiao').show();$('#mapas_atmos_pais').show();var ult=numAtraso;if(numAtrasoZoom>numAtraso)ult=numAtrasoZoom;if(!pro){for(var c=9+ult;c<=16;c++){$("#botao_dia"+c).hide();}
Max=maxImagens;}
$("#botao_dia"+dia_atual+" .seta"+idHora[imagem_atual-2*(dia_atual-1)]).show();}else if(t==5){$('#dataHoraMapa').hide();$('#dataHoraMapaZoom').hide();if(unidadeTemperatura=="c")xEscala=-160;else xEscala=-200;$('#escalas_primarias').show().attr("style","left:"+xEscala+"px;");$('#mapas_oceano_regiao').hide();$('#mapas_oceano_pais').hide();$('#mapas_atmos_regiao').hide();$('#mapas_atmos_pais').hide();$('#imagem_mapa_tempo').hide();$('#imagem_mapa_tempo_br').hide();$('#area_botoes_mapas').hide();$('#imagem_mapa_tsm').show();$('#imagem_mapa_tsm_pais').show();$('#tsm_display_mapas').show();}
selec(imagem_atual);}
var ajustadoVento=false;function mostraValoresMeteoro(){if(!ajustadoVento)ajustaAlturaVento();for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro+1;d++){dd=d-numAtrasoDadosMeteoro;da=diaIniMeteoro+d-1;mm=mesIniMeteoro;if(da>diaFim[mesIniMeteoro]){da-=diaFim[mesIniMeteoro];mm++;if(mm==13)mm=1;}
ds=dSemMeteoro+d-1;while(ds>7){ds-=7;}
for(var h=1;h<=totalHoras;h++){if(!(typeof(dadosVento[d])=="undefined"||typeof(dadosVento[d][h])=="undefined")){objeto1='#dia'+dd+'_hora'+h;objeto2='#title_dia'+dd+'_hora'+h;compl="";objeto3='#vento_dia'+dd+'_hora'+h;objeto4='#title_vento_dia'+dd+'_hora'+h;vv=dadosVento[d][h];$(objeto3).attr("style","height:"+String(unidadesRazao[idUnidVento]*5*vv)+"px;left:"+larg*(h-1)+"px;"+compl);$(objeto4).attr("style","height:"+String(altura_display_vento)+"px;left:"+larg*(h-1)+"px;"+compl);if(tipoVento==0){rr=dadosRajadaVento[d][h]-dadosVento[d][h];objeto3='#rajada_dia'+dd+'_hora'+h;$(objeto3).attr("style","height:"+String(5*rr)+"px;left:"+larg*(h-1)+"px;bottom:"+ +String(unidadesRazao[idUnidVento]*5*vv)+"px;"+compl);}
if(h==ha||h==hb||h==hc||h==hd){switch(h){case ha:nr=1;horario="Madrugada: ";break;case hb:nr=2;horario="Manhã: ";break;case hc:nr=3;horario="Tarde: ";break;case hd:nr=4;horario="Noite: ";}
var bg="";if(praia_id>0&&tipoVento==0){if(dadosRajadaVento[d][h]<=3){tipo_vento="Fraco";bg="background-color:#88d;";}else{tipo_vento=setTipoVento(dadosDirVento[d][h]);if(tipo_vento=="Terral"){bg="background-color:#393;";}
else if(tipo_vento=="Cruzado"){bg="background-color:#f90;";}
else{switch(parseInt(dadosVento[d][h]/5)){case 0:bg="background-color:#f66;";break;case 1:bg="background-color:#e55;";break;case 2:bg="background-color:#d44;";break;case 3:bg="background-color:#c33;";break;case 4:bg="background-color:#b33;";break;case 5:bg="background-color:#a22;";break;case 6:bg="background-color:#911;";break;default:bg="background-color:#800;";}}}
bg=" style='"+bg+"'";tipo_vento=" Vento "+tipo_vento+" | ";}else{tipo_vento="";}
if(tipoVento==0){direcao=dadosDirVento[d][h];}
else{direcao=dadosDirVentoMar[d][h];}
dir=Math.floor((direcao+11.25)/22.5);if(dadosVento[d][h]>0){$("#casa_vento_dia"+dd+" .direcao"+nr).html("<span title='"+horario+tipo_vento+direcoes_graficos_extenso[dir]+" | "+dadosDirVento[d][h]+" graus' class='icone icone-periodo "+direcoes_graficos[dir]+"' "+bg+"></span><div class='txt_dir'>"+direcoes_graficos[dir]+"</div>");}else{$("#casa_vento_dia"+dd+" .direcao"+nr).empty();}}}}}
if(maxTemper>-80&&minTemper<100){drawGraficoTempo();canvasTempo.addEventListener("mousemove",on_mousemove_Tempo,false);}else{$("#box-tempo").hide();}}
function posicionaDadosVento(d,h){var strUnid="m";var unid="";var tipoDir="";var intervalo=3;var altura,periodo,direcao,dir,angulo,angulo2,tipo_vento,bg;altura=periodo=direcao=dir=0;var pos,h,aa,vv,rr;pos=55+parseInt(105.5*(d-1))+13*(h-1)+graficos_dx*xScrollPos;if(pos>320)pos-=280;if(praia_id>0){$("#dados_vento").attr("style","left:"+pos+"px;height:112px;");}else{$("#dados_vento").attr("style","left:"+pos+"px;");}
pos=5+parseInt(106*(d-1))+13*(h-1);$("#linha_vento").show().attr("style","left:"+pos+"px;height:"+String(altura_display_vento+20)+"px;");$("#dados_vento #data2").html(rotuloDia[d]);$("#dados_vento #hora2").html(" &nbsp; "+String(intervalo*(h-1))+":00 h");switch(unid_vento){case 0:unid="nos";break;case 1:unid="Km/h";break;case 2:unid="m/seg";break;case 3:unid="mph";}
if(tipoVento==0){vv=dadosVento[d+numAtrasoDadosMeteoro][h];rr=dadosRajadaVento[d+numAtrasoDadosMeteoro][h];direcao=dadosDirVento[d+numAtrasoDadosMeteoro][h];}else{vv=dadosVentoMar[d+numAtrasoDadosMeteoro][h];rr=0;direcao=dadosDirVentoMar[d+numAtrasoDadosMeteoro][h];}
altura=String(parseInt(unidadesRazao[unid_vento]*vv))+" "+unid;dir=parseInt((direcao+11.25)/22.5);$("#dados_vento #vento_int2").html(altura);if(praia_id>0){tipo_vento=setTipoVento(dadosDirVento[d+numAtrasoDadosMeteoro][h]);$("#dados_vento #vento_dir2").html(direcoes_graficos_extenso[dir]+" ("+tipo_vento+")");}else{$("#dados_vento #vento_dir2").html(direcoes_graficos_extenso[dir]);}
$("#dados_vento #vento_tipo2").html(direcao+"°");if(rr>vv&&tipoVento==0){altura=String(parseInt(unidadesRazao[unid_vento]*rr))+" "+unid;$("#dados_vento #rajada_int2").html("rajadas: "+altura);}else{$("#dados_vento #rajada_int2").html("");}
aa=altura_display_vento+15-fator*unidadesRazao[unid_vento]*vv;$("#linha_vento #marcadorVento").attr("style","top:"+aa+"px;");if(unidadeAltura=='m'){altura=dadosAltura[d+numAtrasoDadosMeteoro][h]/10;altura_surf=dadosSurf[d+numAtrasoDadosMeteoro][h]/10;strUnid="m";}
else{altura=Math.round(dadosAltura[d+numAtrasoDadosMeteoro][h]/3.03);altura_surf=Math.round(dadosSurf[d+numAtrasoDadosMeteoro][h]/3.03);strUnid="pes";}
periodo=Math.round(dadosPeriodo[d+numAtrasoDadosMeteoro][h]/10);direcao=dadosDirPrim[d+numAtrasoDadosMeteoro][h];dir=parseInt((direcao+11.25)/22.5);$("#dados_vento #tot_alt2").html(altura+" "+strUnid);if(!isNaN(altura_surf))$("#dados_vento #tot_alt_surf").html(altura_surf+" "+strUnid);$("#dados_vento #tot_per2").html(periodo+"s");$("#dados_vento #tot_dir2").html(direcoes_graficos_extenso[dir]+" ("+direcao+"°)");}
function apagaDadosVento(){$("#dados_vento").hide();$("#linha_vento").hide();}
function moveGraficos(id){if(xScrollPos0!=xScrollPos){xScrollPos0=xScrollPos;if(id!="ondas")$("#scroll_ondas .dragger").attr("style","left:"+xScrollPos+"px;");if(id!="vento")$("#scroll_vento .dragger").attr("style","left:"+xScrollPos+"px;");if(id!="mapas")$("#scroll_mapas .dragger").attr("style","left:"+xScrollPos+"px;");if(id!="tempo")$("#scroll_tempo .dragger").attr("style","left:"+xScrollPos+"px;");if(id!="energia")$("#scroll_energia .dragger").attr("style","left:"+xScrollPos+"px;");if(estacaoMare!="-"){offsetXmarezinha=-1*xScrollPos*comprimentoMarezinhas/extensao;if(offsetXmarezinha>0)offsetXmarezinha=0;else if(offsetXmarezinha<-1*comprimentoMarezinhas)offsetXmarezinha=-1*comprimentoMarezinhas;desenhaMarezinhas();offsetXmarezona=offsetXmarezinha*comprimentoMarezonas/comprimentoMarezinhas;offsetXtabelaMare=offsetXmarezinha*comprimentoTabelaMare/comprimentoMarezinhas;if(tipoDisplayMare=='tabela')desenhaTabelaMare();else desenhaMarezonas();}
$("#barra_dias").attr("style","left:"+parseInt(barra_dias_dx*xScrollPos)+"px;");dd=Math.ceil(fx*xScrollPos)+1;if(dd>maxImagens)dd=maxImagens;if(dd<=2*offsetMapaAtualizacao)dd=2*offsetMapaAtualizacao+1;if(dd!=imagem_atual){selec(dd);}
$(".envoltorio_graficos_interno").attr("style","left:"+parseInt(graficos_dx*xScrollPos)+"px;");}}
function ondas_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_ondas").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_ondas .dragger").position().left;moveGraficos("ondas");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function vento_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_vento").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_vento .dragger").position().left;moveGraficos("vento");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function mares_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_mares").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_mares .dragger").position().left;moveGraficos("mares");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function mapas_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_mapas").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_mapas .dragger").position().left;moveGraficos("mapas");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function tempo_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_tempo").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_tempo .dragger").position().left;moveGraficos("tempo");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function energia_mousedown(e){if(letreiroOn){$(".aviso_mova").fadeOut(1000,function(){$(".aviso_mova").remove();});letreiroOn=false;}
window.my_dragging={};my_dragging.pageX0=e.pageX;my_dragging.elem=this;my_dragging.offset0=$(this).offset();limiteEsq=$("#scroll_energia").offset().left;limiteDir=limiteEsq+extensao;function handle_dragging(e){var left=my_dragging.offset0.left+(e.pageX-my_dragging.pageX0);if(left>limiteEsq&&left<limiteDir){$(my_dragging.elem).offset({left:left});xScrollPos=$("#scroll_energia .dragger").position().left;moveGraficos("energia");}}
function handle_mouseup(e){$('body').off('mousemove',handle_dragging).off('mouseup',handle_mouseup);}
$('body').on('mouseup',handle_mouseup).on('mousemove',handle_dragging);}
function selec(id){if(id<1)id=1;if(id>16&&!pro){$('#escala_'+tip[tipoImagem]).fadeOut();$('#titulo_'+tip[tipoImagem]).fadeOut();$('.abas').fadeOut();}else{if(id>32)id=32;$('#escala_'+tip[tipoImagem]).fadeIn();$('#titulo_'+tip[tipoImagem]).fadeIn();$('.abas').fadeIn();}
var dia=parseInt((id+1)/2);var hora=id-2*(dia-1);if(dia<1)dia=1;else if(dia>maxDias-offsetMapaAtualizacao){dia=1;id=1;}
var dd=diaHoje+dia-1;var mm=mesHoje;if(dd>diaFim[mm]){dd-=diaFim[mm];mm++;if(mm>12){mm=1;}}
var sd=String(dd);if(dd<10)sd="0"+sd;var ds=diaSemana+dia-1;while(ds>7)ds-=7;var posicaoPro=0;$("div[id^='botao_dia']").each(function(c){$(this)[0].className="quadrado_dia";});$(".seta9").hide();$(".seta15").hide();if($("#botao_dia"+dia).length){$("#botao_dia"+dia)[0].className="quadrado_dia_selecionado";}
$(".diaMapa").html(sd);$(".semanaMapa").html(diaSem[ds]);xImagem=-(id-1+2*offsetMapaAtualizacao)*comprMapa;xImagemBr=-(id-1+2*offsetMapaZoomAtualizacao)*comprMapa;xImagemAtmos=-(id-1+2*offsetMapaAtualizacaoAtmos)*comprMapa;xImagemZoomAtmos=-(id-1+2*offsetMapaZoomAtualizacaoAtmos)*comprMapa;$("#botao_dia"+dia+" .seta"+idHora[hora]).show();if(tipoImagem<5){switch(tipoImagem){case 1:if(unidadeAltura=='m'){yImagem=0;}else{yImagem=-3*alturaMapa;}
$('#mapas_oceano_pais').attr("style","top:"+yImagem+"px;left:"+xImagemBr+"px;");$('#mapas_oceano_regiao').attr("style","top:"+yImagem+"px;left:"+xImagem+"px;");break;case 2:yImagem=-1*alturaMapa;$('#mapas_oceano_pais').attr("style","top:"+yImagem+"px;left:"+xImagemBr+"px;");$('#mapas_oceano_regiao').attr("style","top:"+yImagem+"px;left:"+xImagem+"px;");break;case 3:if(unidadeAltura=='m'){yImagem=-2*alturaMapa;}else{yImagem=-1*alturaMapa;}
$('#mapas_atmos_pais').attr("style","top:"+yImagem+"px;left:"+xImagemZoomAtmos+"px;");$('#mapas_atmos_regiao').attr("style","top:"+yImagem+"px;left:"+xImagemAtmos+"px;");break;case 4:yImagem=0;$('#mapas_atmos_pais').attr("style","top:"+yImagem+"px;left:"+xImagemZoomAtmos+"px;");$('#mapas_atmos_regiao').attr("style","top:"+yImagem+"px;left:"+xImagemAtmos+"px;");break;}
if(pressaoLigada){displayPressao="display:block;";}else{displayPressao="display:none;";}
$('#mapas_pressao_pais').attr("style","left:"+xImagemZoomAtmos+"px;"+displayPressao);$('#mapas_pressao_regiao').attr("style","left:"+xImagemAtmos+"px;"+displayPressao);}
$("#botao_dia"+dia+" .seta"+idHora[hora]).show();if(praia_id>0&&mostraEspectro){if(id!=tauEspectro){tauEspectro=id;try{window.document.movie.SetVariable("xPos",tauEspectro-1);}catch(e){}}}
imagem_atual=id;dia_atual=dia;if(!mapaOff){$('#dataHoraMapa .diaMapa').html(diaEstampa[dia]);$('#dataHoraMapa .semanaMapa').html(diaSem[semEstampa[dia]]);if(hora==1){$('#dataHoraMapa .horaMapa').html(primeiraHora+":00h");}else{$('#dataHoraMapa .horaMapa').html(segundaHora+":00h");}
$('#dataHoraMapaZoom .diaMapa').html(diaEstampa[dia]);$('#dataHoraMapaZoom .semanaMapa').html(diaSem[semEstampa[dia]]);if(hora==1){$('#dataHoraMapaZoom .horaMapa').html(primeiraHora+":00h");}else{$('#dataHoraMapaZoom .horaMapa').html(segundaHora+":00h");}}
drawEspectro(dia,hora-1);}
function drawEspectro(dd,hora){dia=dd+numAtrasoDados;var a,b,p,d,tMax,tMin,per,cor,d0,d1,px,py,v,hh,ai,vento;var direc=false;ctxEspectro.clearRect(0,0,260,260);ctxEspectro.globalAlpha=1;for(d=0;d<24;d++){angIni=270+15*d;if(angIni>360)angIni-=360;if(!(totDir[dia]==undefined||totDir[dia]==null)){if(!(totDir[dia][hora]==undefined||totDir[dia][hora]==null)){if(totDir[dia][hora][d]>0){for(p=5;p<25;p++){v=Math.round(valor[dia][hora][d][p]*50);if(v>0){vv=parseInt(v)+2;if(vv<1)vv=1;if(vv>150)vv=150;}else{vv=1;}
for(a=0;a<limiteAlturaEspectro.length;a++){if(limiteAlturaEspectro[a]>vv){cor=corEspectro[a];break;}}
if(vv>1)drawPartition(d,p,cor);}}}}}
drawRosaEspectro();if(hora==0)hh=3;else hh=5;if(!(dadosVento[dia]==undefined||dadosVento[dia]==null)){if(dadosVento[dia][hh]>0){ai=dadosDirVento[dia][hh]+180;ctxEspectro.lineWidth=2;ctxEspectro.lineWidth=4;ctxEspectro.strokeStyle="#000";ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);px=cxEspectro+2*(dadosVento[dia][hh]+5)*Math.sin(ai*Math.PI/180);py=cyEspectro-2*(dadosVento[dia][hh]+5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);ctxEspectro.stroke();ctxEspectro.lineWidth=2;ctxEspectro.strokeStyle="#ff0";ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);px=cxEspectro+2*(dadosVento[dia][hh]+5)*Math.sin(ai*Math.PI/180);py=cyEspectro-2*(dadosVento[dia][hh]+5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);ctxEspectro.stroke();a=ai-150;ctxEspectro.lineWidth=2;ctxEspectro.strokeStyle="#000";ctxEspectro.beginPath();ctxEspectro.moveTo(px,py);ctxEspectro.lineTo(px+8*Math.sin(a*Math.PI/180),py-8*Math.cos(a*Math.PI/180));a=ai+150;ctxEspectro.lineTo(px+8*Math.sin(a*Math.PI/180),py-8*Math.cos(a*Math.PI/180));ctxEspectro.lineTo(px,py);ctxEspectro.stroke();a=ai-150;ctxEspectro.fillStyle="#ff0";ctxEspectro.beginPath();ctxEspectro.moveTo(px,py);ctxEspectro.lineTo(px+8*Math.sin(a*Math.PI/180),py-8*Math.cos(a*Math.PI/180));a=ai+150;ctxEspectro.lineTo(px+8*Math.sin(a*Math.PI/180),py-8*Math.cos(a*Math.PI/180));ctxEspectro.lineTo(px,py);ctxEspectro.fill();ctxEspectro.fillStyle="#fff";ctxEspectro.beginPath();if(dadosVento[dia][hh]>9)b=24;else b=18;ctxEspectro.fillRect(cxEspectro+12*Math.sin(dadosDirVento[dia][hh]*Math.PI/180)-9,cyEspectro-12*Math.cos(dadosDirVento[dia][hh]*Math.PI/180)-6,b,11);ctxEspectro.fill();ctxEspectro.font="11px arial";ctxEspectro.fillStyle="#000";if(unidadeAltura=='m'){vento=parseInt(1.852*dadosVento[dia][hh])+"k/h";}else{vento=dadosVento[dia][hh]+"kt";}
ctxEspectro.fillText(vento,cxEspectro+12*Math.sin(dadosDirVento[dia][hh]*Math.PI/180)-7,cyEspectro-12*Math.cos(dadosDirVento[dia][hh]*Math.PI/180)+3);}}
drawComponentes(dia,hh);ctxEspectro.fillStyle="#ff0";ctxEspectro.beginPath();ctxEspectro.arc(cxEspectro,cyEspectro,3,0,2*Math.PI,true);ctxEspectro.fill();}
function drawScale(){var h=15;for(var c=2;c<corEspectro.length;c++){ctxEspectro.fillStyle="#"+corEspectro[c];ctxEspectro.fillRect(10,210-h*(c-2),h,50);v=Math.round(25*Math.sqrt(limiteAlturaEspectro[c]/10))/100;ctxEspectro.fillStyle="#000";ctxEspectro.fillText(v,30,210-h*(c-6));}}
function drawComponentes(dia,hh){var a,b,p,d,per,cor,px,py,v,hh,ai,offx,offy,off;var direc=false;ctxEspectro.lineWidth=1;ctxEspectro.strokeStyle="#000";ctxEspectro.font="10px verdana";for(var c=0;c<3;c++){if(!(dadosDirVag[dia]==undefined||dadosDirVag[dia]==null)){switch(c){case 0:ai=dadosDirVag[dia][hh];di=dadosVagas[dia][hh];cor="#9f9";break;case 1:ai=dadosDirSul[dia][hh];di=dadosSul[dia][hh];cor="#f99";break;case 2:ai=dadosDirNorte[dia][hh];di=dadosNorte[dia][hh];cor="#99f";break;}
if(di>0){if(tipoMapaGoogle==0)ctxEspectro.fillStyle='#adf';else ctxEspectro.fillStyle='#346';ctxEspectro.beginPath();px=cxEspectro+15*Math.sin((ai-90)*Math.PI/180)+(raioEspectro+20)*Math.sin(ai*Math.PI/180);py=cyEspectro-15*Math.cos((ai-90)*Math.PI/180)-(raioEspectro+20)*Math.cos(ai*Math.PI/180);ctxEspectro.moveTo(px,py);px=cxEspectro-15*Math.sin((ai-90)*Math.PI/180)+(raioEspectro+20)*Math.sin(ai*Math.PI/180);py=cyEspectro+15*Math.cos((ai-90)*Math.PI/180)-(raioEspectro+20)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro-15*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-5)*Math.sin(ai*Math.PI/180);py=cyEspectro+15*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+15*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-5)*Math.sin(ai*Math.PI/180);py=cyEspectro-15*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+15*Math.sin((ai-90)*Math.PI/180)+(raioEspectro+20)*Math.sin(ai*Math.PI/180);py=cyEspectro-15*Math.cos((ai-90)*Math.PI/180)-(raioEspectro+20)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);ctxEspectro.fill();ctxEspectro.fillStyle=cor;ctxEspectro.beginPath();px=cxEspectro+4*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-5)*Math.sin(ai*Math.PI/180);py=cyEspectro-4*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-5)*Math.cos(ai*Math.PI/180);ctxEspectro.moveTo(px,py);px=cxEspectro+4*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-15)*Math.sin(ai*Math.PI/180);py=cyEspectro-4*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-15)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+8*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-15)*Math.sin(ai*Math.PI/180);py=cyEspectro-8*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-15)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+(raioEspectro-20)*Math.sin(ai*Math.PI/180);py=cyEspectro-(raioEspectro-20)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+8*Math.sin((ai+90)*Math.PI/180)+(raioEspectro-15)*Math.sin(ai*Math.PI/180);py=cyEspectro-8*Math.cos((ai+90)*Math.PI/180)-(raioEspectro-15)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+4*Math.sin((ai+90)*Math.PI/180)+(raioEspectro-15)*Math.sin(ai*Math.PI/180);py=cyEspectro-4*Math.cos((ai+90)*Math.PI/180)-(raioEspectro-15)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+4*Math.sin((ai+90)*Math.PI/180)+(raioEspectro-5)*Math.sin(ai*Math.PI/180);py=cyEspectro-4*Math.cos((ai+90)*Math.PI/180)-(raioEspectro-5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);px=cxEspectro+4*Math.sin((ai-90)*Math.PI/180)+(raioEspectro-5)*Math.sin(ai*Math.PI/180);py=cyEspectro-4*Math.cos((ai-90)*Math.PI/180)-(raioEspectro-5)*Math.cos(ai*Math.PI/180);ctxEspectro.lineTo(px,py);ctxEspectro.stroke();ctxEspectro.fill();if(tipoMapaGoogle==0)ctxEspectro.fillStyle="#000";else ctxEspectro.fillStyle="#fff";offx=0;offy=0;off=0;if(ai>65&&ai<135)offx=10;else if(ai>155&&ai<215){offy=5;offx=10;}
else if(ai>214&&ai<215){offy=5;offx=-10;}
else if(ai>250&&ai<270){offy=-15;}
else if(ai>269&&ai<290){offy=15;}
else if(ai>225&&ai<335){offx=15;}
px=cxEspectro+(raioEspectro+8)*Math.sin(ai*Math.PI/180)-offx;py=cyEspectro-(raioEspectro+8)*Math.cos(ai*Math.PI/180)-offy;if(unidadeAltura=='f'){dj=di;di=Math.round(3.28*di/10);if(di==0){di=Math.round(3.28*dj)/10;}
ctxEspectro.fillText(String(di)+" ft",px,py);}else{ctxEspectro.fillText(String(di/10)+" m",px,py);}
ctxEspectro.fillText(ai+"°",px,py+10);}}}}
function drawPartition(d,p,cor){var angIni,angFim,ai,af,tMax,tMin,direc;var ofs=5.5;angIni=277+15*d;if(angIni>360)angIni-=360;angFim=277+15*d+15;if(angFim>360)angFim-=360;tMax=parseInt((raioEspectro-5)*perEspectro[24-p]/(perEspectro[0]+ofs))+5;tMin=parseInt((raioEspectro-5)*perEspectro[23-p]/(perEspectro[0]+ofs))+5;direc=(angIni>angFim)&&!(angIni>180&&angFim<180);ai=angIni-90;if(ai<0)ai+=360;af=angFim-90;if(af<0)af+=360;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro+tMin*Math.sin(angIni*Math.PI/180),cyEspectro-tMin*Math.cos(angIni*Math.PI/180));ctxEspectro.lineTo(cxEspectro+tMax*Math.sin(angIni*Math.PI/180),cyEspectro-tMax*Math.cos(angIni*Math.PI/180));ctxEspectro.arc(cxEspectro,cyEspectro,tMax,ai*Math.PI/180,af*Math.PI/180,direc);ctxEspectro.lineTo(cxEspectro+tMin*Math.sin(angFim*Math.PI/180),cyEspectro-tMin*Math.cos(angFim*Math.PI/180));ctxEspectro.arc(cxEspectro,cyEspectro,tMin,af*Math.PI/180,ai*Math.PI/180,!direc);ctxEspectro.fillStyle="#"+String(cor);ctxEspectro.fill();}
var direcaoValida=new Array(false,false,false,false,false,false,false,false,false);var ji,jf;function decodEspectro(){var c=0;var d=0;var p,dd,h,cs,Tota,dadosLinha;var fatorEscala=1.0;var maxTam=0;for(var d=1+numAtrasoDados;d<=maxDias+numAtrasoDados;d++){for(h=0;h<2;h++){Tota=0;p=25;dd=0;dadosLinha=false;if(typeof(dadosFator[d])!="undefined"&&typeof(dadosFator[d][h])!="undefined"&&dadosFator[d][h]>0){fat=dadosFator[d][h];el=dadosEnergia[d][h].length;for(cs=0;cs<el;cs++){es=dadosEnergia[d][h].substr(cs,1);if(es=="*"){if(dadosLinha&&dd<24)dd++;dadosLinha=false;for(p=1;p<26;p++){valor[d][h][dd][p]=0;}
dd++;}
else{x=Number(2*(dadosEnergia[d][h].charCodeAt(cs)-61)*fat/1000);valor[d][h][dd][p]=x;totDir[d][h][dd]+=x;Tota=Tota+valor[d][h][dd][p];if(valor[d][h][dd][p]>maxTam){maxTam=valor[d][h][dd][p];}
p--;if(p<1){p=25;dd++;dadosLinha=false;}else{dadosLinha=true;}}}
tamTot[d][h]=parseInt(20*fatorEscala*Tota)/10;}}}
if(praia_id>0){for(c=0;c<8;c++){if((janelaEsq<janelaDir&&(janelaEsq<=45*c&&janelaDir>=45*c))||(janelaEsq>janelaDir&&(janelaEsq<=45*c||janelaDir>=45*c))){direcaoValida[c]=true;}}
ji=janelaEsq-15-90;if(ji<0)ji+=360;jf=janelaDir+15-90;if(jf<0)jf+=360;if(jf<ji){jf+=360;}}else{for(c=0;c<8;c++){direcaoValida[c]=true;}
ji=0;jf=360;}}
function drawRosaEspectro(){var c,p,px,py;ctxEspectro.lineWidth=1;ctxEspectro.strokeStyle="#fff";if(tipoMapaGoogle==0)ctxEspectro.fillStyle="#000";else ctxEspectro.fillStyle="#fff";if(direcaoValida[0]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro,cyEspectro-raioEspectro+10);ctxEspectro.stroke();ctxEspectro.font="14px verdana";ctxEspectro.globalAlpha=1;ctxEspectro.fillText("N",cxEspectro-4,cyEspectro-(raioEspectro-10));}
if(direcaoValida[4]){ctxEspectro.globalAlpha=0.5;ctxEspectro.font="12px arial";ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro,cyEspectro+raioEspectro-10);ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("S",cxEspectro-5,cyEspectro+(raioEspectro));}
if(direcaoValida[2]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro+raioEspectro-10,cyEspectro);ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("L",cxEspectro+(raioEspectro-10),cyEspectro+5);}
if(direcaoValida[6]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro-raioEspectro+10,cyEspectro);ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("O",cxEspectro-(raioEspectro-1),cyEspectro+5);}
ctxEspectro.font="9px arial";for(c=5;c<=20;c+=5){for(p=0;p<25;p++){if(perEspectro[p]<=c){break;}}
p--;tMax=parseInt((raioEspectro-5)*perEspectro[p]/perEspectro[0])+5;for(a=ji;a<jf;a+=5){ctxEspectro.beginPath();ctxEspectro.arc(cxEspectro,cyEspectro,tMax,a*Math.PI/180,(a+2)*Math.PI/180,false);ctxEspectro.stroke();}
if(direcaoValida[0])ctxEspectro.fillText(String(c),cxEspectro-6+3*(c<10),cyEspectro-tMax+5);if(direcaoValida[4])ctxEspectro.fillText(String(c),cxEspectro-6+3*(c<10),cyEspectro+tMax+5);if(direcaoValida[6])ctxEspectro.fillText(String(c),cxEspectro-tMax-5+3*(c<10),cyEspectro+3);if(direcaoValida[2])ctxEspectro.fillText(String(c),cxEspectro+tMax-5+3*(c<10),cyEspectro+3);}
ctxEspectro.font="10px verdana";if(direcaoValida[5]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro+(raioEspectro-15)*Math.cos(225*Math.PI/180),cyEspectro-(raioEspectro-15)*Math.sin(225*Math.PI/180));ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("SO",cxEspectro+(raioEspectro+9)*Math.cos(223*Math.PI/180)+10,cyEspectro-(raioEspectro+9)*Math.sin(223*Math.PI/180));}
if(direcaoValida[7]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro+(raioEspectro-15)*Math.cos(135*Math.PI/180),cyEspectro-(raioEspectro-15)*Math.sin(135*Math.PI/180));ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("NO",cxEspectro+(raioEspectro+5)*Math.cos(142*Math.PI/180)+10,cyEspectro-(raioEspectro+5)*Math.sin(142*Math.PI/180));}
if(direcaoValida[1]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro+(raioEspectro-15)*Math.cos(45*Math.PI/180),cyEspectro-(raioEspectro-15)*Math.sin(45*Math.PI/180));ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("NE",cxEspectro+(raioEspectro)*Math.cos(45*Math.PI/180)-10,cyEspectro-(raioEspectro-5)*Math.sin(45*Math.PI/180));}
if(direcaoValida[3]){ctxEspectro.globalAlpha=0.5;ctxEspectro.beginPath();ctxEspectro.moveTo(cxEspectro,cyEspectro);ctxEspectro.lineTo(cxEspectro+(raioEspectro-15)*Math.cos(315*Math.PI/180),cyEspectro-(raioEspectro-15)*Math.sin(315*Math.PI/180));ctxEspectro.stroke();ctxEspectro.globalAlpha=1;ctxEspectro.fillText("SE",cxEspectro+(raioEspectro+6)*Math.cos(310*Math.PI/180)-10,cyEspectro-(raioEspectro-5)*Math.sin(310*Math.PI/180));}
ctxEspectro.fillStyle="#000";ctxEspectro.beginPath();ctxEspectro.arc(cxEspectro,cyEspectro,5,0,2*Math.PI,true);ctxEspectro.fill();}
function carregaCameras(){var fonte=webroot+"cameras/ajax/"+cidade_id;if(!cameraOk){$('#aguarde_a_camera').fadeIn(2000,function(){lerCamera(fonte)});}
else{$('#camera_display').fadeOut(1000,function(){$('#camera_display').empty().show();$('#conteudo-box10').height("140px;")});cameraOk=false;}}
function lerCamera(fonte){$('#camera_display').load(fonte,function(){cameraOk=true;ajustaAlturaCamera();$('#aguarde_a_camera').hide(500);});}
function ajustaAlturaCamera(){var alturaCamera=Math.floor(document.cam_form.altura.value);$('#conteudo-box10').animate({height:String(alturaCamera)+"px"},1000,function(){$('#arrudeia_cameras').fadeIn(1000);});}
function mostraCam(id){var fonte=webroot+"cameras/cam/"+id;$('#camera_container').load(fonte);}
var mostraProcura=false;function mostra_procura(){if(!mostraProcura){mostraProcura=true;$('#area_navegacao').hide();$('#form-procura').fadeIn(500);$('#nome-procura').focus();}else{mostraProcura=false;$('#form-procura').hide();$('#area_navegacao').fadeIn(500);$('#sugestoes').hide();$("li[id^='sugestao']").each(function(c){$(this)[0].remove();});$('#nome-procura').val("");}}
function mostraDadosSurf(id){if(id==0){mostraSurf=true;$("#aba_surf0 a")[0].className="ativo";$("#aba_surf1 a")[0].className="normal";}else{mostraSurf=false;$("#aba_surf1 a")[0].className="ativo";$("#aba_surf0 a")[0].className="normal";}
mostraValoresOceano();}
var tipoVento=0;function mostraTipoVento(tt){tipoVento=tt;var compl="";var ha,hb,hc,hd,direcao,nr=0;var dadoValido=false;ha=2;hb=4;hc=6;hd=8;if(previsaoAntiga){totalHoras=4;larg=26;compl="width:"+larg+"px;";}
if(tt==0){$("#label_vento").show();$("#aviso_cor_direcao_vento").show();$("#aba_vento_0 a")[0].className="ativo";$("#aba_vento_1 a")[0].className="normal";}else{$("#label_vento").hide();$("#aviso_cor_direcao_vento").hide();$("#aba_vento_1 a")[0].className="ativo";$("#aba_vento_0 a")[0].className="normal";}
var mv=parseInt(5*unidadesRazao[idUnidVento]*maxVento);if(mv<180)mv=180;for(var d=1+numAtrasoDadosMeteoro;d<=maxDias+numAtrasoDadosMeteoro;d++){for(var h=1;h<=totalHoras;h++){dd=d-numAtrasoDadosMeteoro;objeto3='#vento_dia'+dd+'_hora'+h;objeto4='#title_vento_dia'+dd+'_hora'+h;if(tipoVento==0){if(!(dadosVento[d]==undefined||dadosVento[d][h]==undefined))vv=dadosVento[d][h];else vv=0;}else{if(!(dadosVentoMar[d]==undefined||dadosVentoMar[d][h]==undefined))vv=dadosVentoMar[d][h];else vv=0;}
dadoValido=(vv>0);$(objeto3).attr("style","height:"+String(5*parseInt(unidadesRazao[idUnidVento]*vv))+"px;left:"+larg*(h-1)+"px;"+compl);$(objeto4).attr("style","height:"+String(mv)+"px;left:"+larg*(h-1)+"px;"+compl);if(tipoVento==0&&!(typeof(dadosRajadaVento[d])=="undefined"||typeof(dadosRajadaVento[d][h])=="undefined")){rr=dadosRajadaVento[d][h]-dadosVento[d][h];}else{rr=0;}
objeto3='#rajada_dia'+dd+'_hora'+h;$(objeto3).attr("style","height:"+String(5*parseInt(unidadesRazao[idUnidVento]*rr))+"px;left:"+larg*(h-1)+"px;bottom:"+String(5*parseInt(unidadesRazao[idUnidVento]*vv))+"px;"+compl);if(h==ha||h==hb||h==hc||h==hd){switch(h){case ha:nr=1;horario="Madrugada: ";break;case hb:nr=2;horario="Manha: ";break;case hc:nr=3;horario="Tarde: ";break;case hd:nr=4;horario="Noite: ";}
if(tipoVento==0&&!(typeof(dadosDirVento[d])=="undefined"||typeof(dadosDirVento[d][h])=="undefined")){direcao=dadosDirVento[d][h];if(praia_id>0){if(dadosRajadaVento[d][h]<=3){tipo_vento="Fraco";bg="background-color:#88d;";}else{tipo_vento=setTipoVento(dadosDirVento[d][h]);if(tipo_vento=="Terral"){bg="background-color:#393;";}
else if(tipo_vento=="Cruzado"){bg="background-color:#f90;";}
else{switch(parseInt(dadosVento[d][h]/5)){case 0:bg="background-color:#f66;";break;case 1:bg="background-color:#e55;";break;case 2:bg="background-color:#d44;";break;case 3:bg="background-color:#c33;";break;case 4:bg="background-color:#b33;";break;case 5:bg="background-color:#a22;";break;case 6:bg="background-color:#911;";break;default:bg="background-color:#800;";}}}
bg=" style='"+bg+"' ";}else{bg="";}}
else{if(!(typeof(dadosDirVentoMar[d])=="undefined"||typeof(dadosDirVentoMar[d][h])=="undefined")){direcao=dadosDirVentoMar[d][h];}
bg="";}
dir=Math.floor((direcao+11.25)/22.5);if(dadoValido){$("#casa_vento_dia"+dd+" .direcao"+nr).html("<span title='"+horario+direcoes_graficos_extenso[dir]+" | "+direcao+" graus' class='icone icone-periodo "+direcoes_graficos[dir]+"' "+bg+"></span><div class='txt_dir'>"+direcoes_graficos[dir]+"</div>");}else{$("#casa_vento_dia"+dd+" .direcao"+nr).empty();}}}}}